<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenKoreanLearningLab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;600;700&family=Jua&family=Noto+Sans+KR:wght@400;500;700;900&family=Sunflower:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        html { font-size: clamp(12px, 1vw, 16px); }
        @font-face { font-family: 'NanumSquareRound'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/NanumSquareRound.woff') format('woff'); font-weight: normal; font-display: swap; }
        body { font-family: 'NanumSquareRound', sans-serif; background-color: #f9fafb; color: #334155; }
        .font-basic { font-family: 'NanumSquareRound', sans-serif; }
        .font-jua { font-family: 'Jua', sans-serif; }
        .font-noto { font-family: 'Noto Sans KR', sans-serif; }
        .font-sunflower { font-family: 'Sunflower', sans-serif; }
        .font-nanum-round { font-family: 'NanumSquareRound', sans-serif; }
        @font-face { font-family: 'Cafe24SurroundAir'; src: url('https://gcore.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/Cafe24SsurroundAir.woff') format('woff'); font-weight: normal; font-display: swap; }
        .font-cafe24 { font-family: 'Cafe24SurroundAir', sans-serif; }
        @font-face { font-family: 'Cafe24Surround'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/Cafe24Ssurround.woff') format('woff'); font-weight: normal; font-display: swap; }
        .font-cafe24-surround { font-family: 'Cafe24Surround', sans-serif; }
        @font-face { font-family: 'Cafe24Decoshadow'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2405-3@1.1/Cafe24Decoshadow.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-cafe24-deco { font-family: 'Cafe24Decoshadow', sans-serif; }
        @font-face { font-family: 'Cafe24Decoschool'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2405-3@1.1/Cafe24Decoschool.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-cafe24-school { font-family: 'Cafe24Decoschool', sans-serif; }
        @font-face { font-family: 'Cafe24Anemone'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/Cafe24Ohsquare.woff') format('woff'); font-weight: normal; font-display: swap; }
        .font-cafe24-anemone { font-family: 'Cafe24Anemone', sans-serif; }
        @font-face { font-family: 'SchoolSafetyRoundedSmile'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimDunggeunmisoTTF-R.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        @font-face { font-family: 'SchoolSafetyRoundedSmile'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimDunggeunmisoTTF-B.woff2') format('woff2'); font-weight: 700; font-display: swap; }
        .font-school-smile { font-family: 'SchoolSafetyRoundedSmile', sans-serif; }
        @font-face { font-family: 'SchoolSafetyFreeTime'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2508-2@1.0/HakgyoansimJayusiganR.woff2') format('woff2'); font-weight: normal; font-style: normal; }
        .font-school-free { font-family: 'SchoolSafetyFreeTime', sans-serif; }
        @font-face { font-family: 'Juache'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/BMJUA.woff') format('woff'); font-weight: normal; font-display: swap; }
        .font-juache { font-family: 'Juache', sans-serif; }
        @font-face { font-family: 'SchoolSafetyOcarina'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2511-1@1.0/HakgyoansimOcarinaR.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-ocarina { font-family: 'SchoolSafetyOcarina', sans-serif; }
        @font-face { font-family: 'SchoolSafetyPictureDiary'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimGeurimilgiTTF-R.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-diary { font-family: 'SchoolSafetyPictureDiary', sans-serif; }
        @font-face { font-family: 'SchoolSafeBoardMarker'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2511-1@1.0/HakgyoansimBoadmarkerR.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-marker { font-family: 'SchoolSafeBoardMarker', sans-serif; }
        @font-face { font-family: 'SchoolSafeDictation'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimBadasseugiTTF-L.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-dictation { font-family: 'SchoolSafeDictation', sans-serif; }
        @font-face { font-family: 'Cafe24Gowoonbam'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.1/Cafe24Oneprettynight.woff') format('woff'); font-weight: normal; font-display: swap; }
        .font-gowoonbam { font-family: 'Cafe24Gowoonbam', sans-serif; }
        @font-face { font-family: 'SchoolSafetyMustache'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2402_keris@1.0/TTHakgyoansimKossuyeomR.woff2') format('woff2'); font-weight: normal; font-display: swap; }
        .font-mustache { font-family: 'SchoolSafetyMustache', sans-serif; }
        ::-webkit-scrollbar { width: 0.375rem; height: 0.375rem; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 0.1875rem; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(0.625rem); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 0.75rem; width: 0.75rem; border-radius: 50%; background: var(--thumb-color, #22c55e); cursor: pointer; margin-top: -0.25rem; border: 1px solid white; box-shadow: 0 1px 2px rgba(0,0,0,0.15); }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 0.25rem; cursor: pointer; background: #e2e8f0; border-radius: 0.125rem; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;
        const { createPortal } = ReactDOM;

        const LEVEL_DEFINITIONS = {
            "A1": { title: "Novice", desc: "Can use and understand very simple everyday expressions. Can introduce themselves, ask and answer basic questions." },
            "A1+": { title: "Pre-Beginner", desc: "Still beginner, but can handle slightly more than A1." },
            "A2": { title: "Beginner", desc: "Can understand frequently used sentences (family, shopping, work, hobbies)." },
            "A2+": { title: "Upper Beginner", desc: "Between A2 and B1. Can speak a bit more smoothly about daily life." },
            "B1": { title: "Pre-Intermediate", desc: "Can understand the main points of clear standard speech or texts on familiar topics." },
            "B1+": { title: "Lower Intermediate", desc: "Stronger B1. More comfortable carrying conversations." },
            "B2": { title: "Intermediate", desc: "Can understand the main ideas of complex texts." },
            "B2+": { title: "Upper Intermediate", desc: "Near C1. Can argue a point logically." },
            "C1": { title: "Advanced", desc: "Can understand long, demanding texts and implied meanings." },
            "C1+": { title: "Upper Advanced", desc: "Very strong C1, approaching native-like flexibility." },
            "C2": { title: "Proficient", desc: "Can understand virtually everything heard or read." }
        };

        const VOCAB_DATA = [
            {
                term: 'ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”',
                mainDef: "Let's talk about this topic",
                variants: ['<ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”>', 'ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”'],
                examples: [{ kor: 'ìš°ë¦¬ ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”.', eng: "Let's talk about this topic." }],
                subDefs: [
                    { subTerm: 'ì£¼ì œ', subDef: 'topic, subject' },
                    { subTerm: '-ë¡œ', subDef: 'particle meaning "about" or "with (a topic)"' },
                    { subTerm: 'ì´ì•¼ê¸°í•˜ë‹¤', subDef: 'to talk, to have a conversation' },
                    { subTerm: '-ì•„/ì–´ ë³´ë‹¤', subDef: 'used to make gentle suggestions without sounding pushy, meaning "try doing..." or "let\'s try..."' }
                ]
            },
            {
                term: 'ì¤‘ìš”í•œ ì´ì•¼ê¸°',
                mainDef: 'an important story',
                variants: ['ì¤‘ìš”í•œ ì´ì•¼ê¸°ë¥¼'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì¤‘ìš”í•˜ë‹¤', subDef: 'to be important' },
                    { subTerm: '-ëŠ”', subDef: 'used to turn a present-tense verb into an "adjective-ish" phrase that describes the following noun' }
                ]
            },
            {
                term: '-ì•¼ í•´ìš”',
                mainDef: '"have toâ€¦" or "mustâ€¦"',
                variants: ['í•´ì•¼ í•´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'Grammar', subDef: 'used to express necessity or obligation' }
                ]
            },
            {
                term: 'ê³ ì¥ë‚˜ë‹¤',
                mainDef: 'to break down, to malfunction',
                variants: ['ê³ ì¥ë‚¬ì–´ìš”', 'ê³ ì¥ë‚˜ë‹¤', 'ê³ ì¥ë‚¬ê³ ', 'ê³ ì¥ë‚¬ì„', 'ê³ ì¥ì´', 'ê³ ì¥ë‚˜ë©´'],
                examples: [],
                subDefs: []
            },
            {
                term: '-ë¼ëŠ” ëœ»ì´ì—ìš”',
                mainDef: '"It means thatâ€¦"',
                variants: ['ëœ»ì´ì—ìš”', 'ë¼ëŠ” ëœ»ì´ì—ìš”', 'ë‹¤ëŠ” ëœ»ì´ì—ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-(ì´)ë¼ëŠ” ëœ»', subDef: 'used to state the meaning of a word or phrase' }
                ]
            },
            {
                term: 'ê·¸ë˜ì„œìš”?',
                mainDef: 'So what?',
                variants: ['ê·¸ë˜ì„œìš”', 'ê·¸ë˜ì„œìš”?'],
                examples: [],
                subDefs: [
                    { subTerm: 'Meaning', subDef: 'expressing indifference or asking for more explanation' }
                ]
            },
            {
                term: 'ì£½ì„ ë»”í•˜ë‹¤',
                mainDef: 'to almost die',
                variants: ['ì£½ì„ ë»”í–ˆì–´ìš”', 'ì£½ì„ ë»”í•´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ã„¹/ì„ ë»”í•˜ë‹¤', subDef: '"almost didâ€¦"; used to express that something nearly happened' }
                ]
            },
            {
                term: 'í•œë²ˆë„',
                mainDef: 'not even once, never',
                variants: ['í•œë²ˆë„'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ìŠµí•´ì„œ',
                mainDef: 'because it\'s humid',
                variants: ['ìŠµí•´ì„œ'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect clauses indicating cause or reason ("becauseâ€¦")' }
                ]
            },
            {
                term: 'ìŠµí•˜ë‹¤',
                mainDef: 'to be humid, to be damp',
                variants: ['ìŠµí•˜ë‹¤', 'ìŠµí•˜ë‹¤ëŠ”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¬¼ê³ ê¸°ê°€ ë  ë»”í–ˆì–´ìš”.',
                mainDef: 'I almost became a fish.',
                variants: ['ë¬¼ê³ ê¸°ê°€ ë  ë»”í–ˆì–´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ë¬¼ê³ ê¸°', subDef: 'fish' },
                    { subTerm: 'ë˜ë‹¤', subDef: 'to become' },
                    { subTerm: '-ã„¹/ì„ ë»”í•˜ë‹¤', subDef: '"almost didâ€¦"; used to express that something nearly happened' }
                ]
            },
            {
                term: 'ì –ì€ ê²ƒ ê°™ë‹¤',
                mainDef: 'seems wet',
                variants: ['ì –ì€ ê²ƒ ê°™ë‹¤', 'ì –ì€ ê²ƒ ê°™ë‹¤ëŠ”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì –ë‹¤', subDef: 'to get wet' },
                    { subTerm: '-ã„´/ì€ ê²ƒ ê°™ë‹¤', subDef: '"seems likeâ€¦" or "looks likeâ€¦"; used to express assumption or impression' }
                ]
            },
            {
                term: 'ê³¼ì¥í•´ì„œ ë§í•˜ë‹¤',
                mainDef: 'to speak exaggeratedly',
                variants: ['ê³¼ì¥í•´ì„œ ë§í•´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect two verbs, indicating that the first action is performed as the means or method for the second' }
                ]
            },
            {
                term: 'ê³¼ì¥í•˜ë‹¤',
                mainDef: 'to exaggerate',
                variants: ['ê³¼ì¥í•˜ë‹¤ëŠ”', 'ê³¼ì¥í•˜ë‹¤'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì‚¬ì‹¤ì„ ë§í•˜ì§€ë§Œ',
                mainDef: 'telling the truth, butâ€¦',
                variants: ['ì‚¬ì‹¤ì„ ë§í•˜ì§€ë§Œ'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì‚¬ì‹¤', subDef: 'fact, truth' },
                    { subTerm: '-ì§€ë§Œ', subDef: '"but" or "although"; used to contrast two clauses' }
                ]
            },
            {
                term: 'ê±°ì§“ë§ì„ í•˜ë‹¤',
                mainDef: 'to lie, to tell a lie',
                variants: ['ê±°ì§“ë§ì„ í•˜ë‹¤'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì—ì–´ì»¨ì´ ê³ ì¥ë‚œ ì  ì—†ì£ ?',
                mainDef: 'You\'ve never had your air conditioner break down, right?',
                variants: ['ì—ì–´ì»¨ì´ ê³ ì¥ë‚œ ì  ì—†ì£ '],
                examples: [],
                subDefs: [
                    { subTerm: 'ê³ ì¥ë‚˜ë‹¤', subDef: 'to break down, to malfunction' },
                    { subTerm: '-ã„´/ì€ ì  ì—†ë‹¤', subDef: 'used to say "have never done [verb]" or to express that you\'ve had no experience of doing [verb]' }
                ]
            },
            {
                term: 'ê²½í—˜í•´ ë´¤ì–´ìš”',
                mainDef: 'I\'ve experienced it.',
                variants: ['ê²½í—˜í•´ ë´¤ì–´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ê²½í—˜í•˜ë‹¤', subDef: 'to experience' },
                    { subTerm: '-ì•„/ì–´ ë´¤ì–´ìš”', subDef: '"have triedâ€¦" or "have doneâ€¦"; used to express past experience' }
                ]
            },
            {
                term: 'ì‘ë…„',
                mainDef: 'last year',
                variants: ['ì‘ë…„'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì‹¬ì§€ì–´',
                mainDef: 'even, moreover',
                variants: ['ì‹¬ì§€ì–´'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ìƒí™©',
                mainDef: 'situation',
                variants: ['ìƒí™©ì´'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë”ì°í•˜ë‹¤',
                mainDef: 'to be terrible, to be horrible',
                variants: ['ë”ì°í–ˆì–´ìš”', 'ë”ì°í•˜ë‹¤ëŠ”', 'ë”ì°í•˜ë‹¤'],
                examples: [],
                subDefs: []
            },
            {
                term: '-ì„/ë¥¼ ë•Œì˜ˆìš”',
                mainDef: '"whenâ€¦"',
                variants: ['ë•Œì˜ˆìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'Usage', subDef: 'used to indicate the time when something happens' }
                ]
            },
            {
                term: '-ë¼ëŠ” ëœ»ì´ì£ ?',
                mainDef: '"It meansâ€¦, right?"',
                variants: ['ëœ»ì´ì£ '],
                examples: [],
                subDefs: [
                    { subTerm: 'Usage', subDef: 'asking for confirmation about meaning' },
                    { subTerm: '-ì£ ?', subDef: 'tag question particle used to seek agreement or confirmation' }
                ]
            },
            {
                term: 'ë‹¹ì—°íˆ',
                mainDef: 'of course',
                variants: ['ë‹¹ì—°íˆ'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë§ë„ ì•ˆ ë¼ìš”',
                mainDef: 'That doesn\'t make sense! That\'s ridiculous!',
                variants: ['ë§ë„ ì•ˆ ë¼ìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: '100ë°°',
                mainDef: '100 times',
                variants: ['100ë°°'],
                examples: [],
                subDefs: [
                    { subTerm: '-ë°°', subDef: 'counter suffix meaning "times" or "fold"; used to indicate multiples or degrees of comparison (e.g., 2ë°° = 2 times, 10ë°° = 10 times)' }
                ]
            },
            {
                term: 'ê³¼ì¥í•´ì„œ ë§í•˜ë„¤ìš”',
                mainDef: 'You\'re speaking exaggeratedly (again)',
                variants: ['ê³¼ì¥í•´ì„œ ë§í•˜ë„¤ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ë„¤ìš”', subDef: 'sentence ending expressing surprise or realization' }
                ]
            },
            {
                term: 'ë³´ì¼ëŸ¬ê°€ ì—†ìœ¼ë©´',
                mainDef: 'if there\'s no boiler',
                variants: ['ë³´ì¼ëŸ¬ê°€ ì—†ìœ¼ë©´'],
                examples: [],
                subDefs: [
                    { subTerm: '-ë©´/ìœ¼ë©´', subDef: '"ifâ€¦"; conditional particle' }
                ]
            },
            {
                term: 'ì–¼ì–´ ì£½ì„ ìˆ˜ë„ ìˆì–´ìš”',
                mainDef: 'might freeze to death',
                variants: ['ì–¼ì–´ ì£½ì„ ìˆ˜ë„ ìˆì–´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì„/ë¥¼ ìˆ˜ë„ ìˆë‹¤', subDef: '"mightâ€¦" or "couldâ€¦"; used to express possibility' }
                ]
            },
            {
                term: 'ì–¼ì–´ ì£½ë‹¤',
                mainDef: 'to freeze to death',
                variants: ['ì–¼ì–´ ì£½ë‹¤', 'ì–¼ì–´ ì£½ì§€'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì–¼ë‹¤', subDef: 'to freeze' },
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect clauses indicating cause or reason ("becauseâ€¦")' }
                ]
            },
            {
                term: 'ì¶”ì›Œì„œ',
                mainDef: 'because it\'s cold',
                variants: ['ì¶”ì›Œì„œ'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect clauses indicating cause or reason ("becauseâ€¦")' }
                ]
            },
            {
                term: 'ìœ„í—˜í•˜ë‹¤',
                mainDef: 'to be dangerous',
                variants: ['ìœ„í—˜í•´ìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë…¹ë‹¤',
                mainDef: 'to melt',
                variants: ['ë…¹ì•„ìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë”ì›Œì„œ',
                mainDef: 'because it\'s hot',
                variants: ['ë”ì›Œì„œ'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect clauses indicating cause or reason ("becauseâ€¦")' }
                ]
            },
            {
                term: 'ì˜·ì„ ë‹¤ ë²—ë‹¤',
                mainDef: 'to take off all clothes',
                variants: ['ì˜·ë„ ë‹¤ ë²—ì—ˆì–´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ë‹¤', subDef: 'all, completely' },
                    { subTerm: 'ë²—ë‹¤', subDef: 'to take off (clothes)' }
                ]
            },
            {
                term: 'TMI',
                mainDef: 'Too Much Information (English loanword)',
                variants: ['TMIì˜ˆìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì•„ë¬´íŠ¼',
                mainDef: 'anyway, anyhow',
                variants: ['ì•„ë¬´íŠ¼'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ê»´ì…ë‹¤',
                mainDef: 'to layer clothes, to wear multiple layers',
                variants: ['ê»´ì…ì„', 'ê»´ì…ë‹¤ëŠ”', 'ê»´ì…ë‹¤'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ê·¸ëŸ¬ë©´',
                mainDef: 'then, in that case',
                variants: ['ê·¸ëŸ¬ë©´'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì˜·ì„ ì—¬ëŸ¬ ê°œ ì…ëŠ” ê±°ì˜ˆìš”',
                mainDef: 'It\'s wearing multiple clothes',
                variants: ['ì˜·ì„ ì—¬ëŸ¬ ê°œ ì…ëŠ” ê±°ì˜ˆìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ëŠ” ê²ƒì´ë‹¤', subDef: 'used to state or explain a fact or essence, often translating as "it is thatâ€¦" or "the fact is thatâ€¦"' }
                ]
            },
            {
                term: 'ì–¼ì–´ì„œ',
                mainDef: 'because it freezes',
                variants: ['ì–¼ì–´ì„œ'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used to connect clauses indicating cause or reason ("becauseâ€¦")' }
                ]
            },
            {
                term: 'ë¬¼ì´ ì•ˆ ë‚˜ì˜¤ë‹¤',
                mainDef: 'water doesn\'t come out',
                variants: ['ì•ˆ ë‚˜ì˜¬ ìˆ˜ë„'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì–¼ë‹¤',
                mainDef: 'to freeze',
                variants: ['ì–¼ì–´ìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•˜ë‹¤',
                mainDef: 'to think before speaking',
                variants: ['ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ê¸° ì „ì—', subDef: '"before doingâ€¦"; used to indicate an action that happens before another' }
                ]
            },
            {
                term: 'ë§ˆì‹œì–ì•„ìš”.',
                mainDef: 'You drink (it), don\'t you?',
                variants: ['ë§ˆì‹œì–ì•„ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì–ì•„ìš”', subDef: 'used to remind the listener of shared or obvious information, or to emphasize that something is already known' }
                ]
            },
            {
                term: 'ì–¼ì–´ ì£½ì–´ë„',
                mainDef: 'even if I freeze to death',
                variants: ['ì–¼ì–´ ì£½ì–´ë„'],
                examples: [],
                subDefs: [
                    { subTerm: '-ì•„ë„/ì–´ë„', subDef: '"even ifâ€¦" or "even thoughâ€¦"; used to express concession' }
                ]
            },
            {
                term: 'ì•Œê² ì–´ìš”',
                mainDef: 'I understand/got it',
                variants: ['ì•Œê² ì–´ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì•Œë‹¤', subDef: 'to know' },
                    { subTerm: '-ê² ë‹¤', subDef: 'used to indicate the speaker\'s intention or determination ("willâ€¦") or to express understanding' }
                ]
            },
            {
                term: 'ê³ ì¹˜ë‹¤',
                mainDef: 'to fix, to repair',
                variants: ['ê³ ì³¤ì–´ìš”', 'ê³ ì¹˜ë‹¤', 'ê³ ì¹˜ë‹¤ëŠ”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“¤ë‹¤',
                mainDef: 'to make it usable again',
                variants: ['ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“¤ë‹¤'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì“°ë‹¤', subDef: 'to use' },
                    { subTerm: '-ã„¹/ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ë‹¤', subDef: '"to make it so thatâ€¦can be done"; causative expression' }
                ]
            },
            {
                term: 'ê¸°ë‹¤ë¦¬ë‹¤',
                mainDef: 'to wait',
                variants: ['ê¸°ë‹¤ë ¤ì•¼ í•´ìš”'],
                examples: [],
                subDefs: []
            },
            {
                term: 'ì•ˆ ëë„¤ìš”',
                mainDef: 'That\'s too bad, I feel sorry for you',
                variants: ['ì•ˆ ëë„¤ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ë„¤ìš”', subDef: 'sentence ending expressing surprise or realization' }
                ]
            },
            {
                term: 'ê³ ì¹˜ëŸ¬ ì™€ìš”',
                mainDef: 'Someone comes to fix it',
                variants: ['ê³ ì¹˜ëŸ¬ ì™€ìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ëŸ¬ ì˜¤ë‹¤', subDef: '"to come to doâ€¦"; used to express purpose of coming' }
                ]
            },
            {
                term: 'ì¤‘ìš”í•˜ë‹ˆê¹Œìš”',
                mainDef: 'because it\'s important',
                variants: ['ì¤‘ìš”í•˜ë‹ˆê¹Œìš”'],
                examples: [],
                subDefs: [
                    { subTerm: '-ë‹ˆê¹Œìš”', subDef: 'used to state a reason or cause ("becauseâ€¦"), often in response to a question' }
                ]
            },
            {
                term: 'ë°°ìš´ ë‹¨ì–´',
                mainDef: 'learned words/vocabulary',
                variants: ['ë°°ìš´ ë‹¨ì–´'],
                examples: [],
                subDefs: [
                    { subTerm: 'ë°°ìš°ë‹¤', subDef: 'to learn' },
                    { subTerm: '-ã„´/ì€', subDef: 'used to turn a past-tense verb into an "adjective-ish" phrase that describes the following noun' },
                    { subTerm: 'ë‹¨ì–´', subDef: 'word, vocabulary' }
                ]
            },
            {
                term: 'ì •ë¦¬í•´ ë³¼ê¹Œìš”?',
                mainDef: 'Shall we summarize?',
                variants: ['ì •ë¦¬í•´ ë³¼ê¹Œìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì •ë¦¬í•˜ë‹¤', subDef: 'to summarize, to organize' },
                    { subTerm: '-ì•„/ì–´ ë³¼ê¹Œìš”?', subDef: '"Shall weâ€¦?" "How aboutâ€¦?"; used to suggest trying something together' }
                ]
            },
            {
                term: 'ì£½ì„ ìˆ˜ ìˆì§€ë§Œ, ì§„ì§œ ì£½ì§€ ì•Šë‹¤',
                mainDef: 'can die, but never really die',
                variants: ['ì£½ì„ ìˆ˜ ìˆì§€ë§Œ, ì§„ì§œ ì£½ì§€ ì•Šë‹¤'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì£½ë‹¤', subDef: 'to die' },
                    { subTerm: '-ì§€ë§Œ', subDef: '"but" or "although"; used to contrast two clauses' },
                    { subTerm: '-ì§€ ì•Šë‹¤', subDef: 'negative form "do notâ€¦"' }
                ]
            },
            {
                term: "'íŒ€ ìš°ë””'ì¸ì§€ 'íŒ€ ìœ ë‚˜'ì¸ì§€ ì•Œë ¤ì£¼ì„¸ìš”!",
                mainDef: "Please tell us whether you're 'Team Woody' or 'Team Yuna'!",
                variants: ["'íŒ€ ìš°ë””'ì¸ì§€ 'íŒ€ ìœ ë‚˜'ì¸ì§€ ì•Œë ¤ì£¼ì„¸ìš”"],
                examples: [],
                subDefs: [
                    { subTerm: 'íŒ€', subDef: 'team' },
                    { subTerm: '-ì¸ì§€ ì•Œë ¤ì£¼ë‹¤', subDef: '"tell us whetherâ€¦"; used to ask someone to inform about a choice' }
                ]
            },
            {
                term: 'ë°”ëŒì´ì£ ',
                mainDef: 'That\'s (just) your wish/hope',
                variants: ['ë°”ëŒì´ì£ '],
                examples: [],
                subDefs: [
                    { subTerm: 'ë°”ëŒ', subDef: 'wish, hope, desire' },
                    { subTerm: '-ì´ì£ /ì£ ', subDef: 'informal sentence ending used for confirmation or emphasis' }
                ]
            },
            {
                term: 'ì—¬ê¸°ê¹Œì§€ì˜ˆìš”',
                mainDef: 'That\'s all for now',
                variants: ['ì—¬ê¸°ê¹Œì§€ì˜ˆìš”'],
                examples: [],
                subDefs: [
                    { subTerm: 'ì—¬ê¸°ê¹Œì§€', subDef: 'up to here, this far' }
                ]
            }
        ];

        const QUIZ_LIST = [
            { id: 1, parts: ["ì–´ì œ ìš°ë”” ì”¨ ì§‘ ì—ì–´ì»¨ì´ ", "."], blank: 'broke down', answer: 'ê³ ì¥ë‚¬ì–´ìš”', bank: ['ê³ ì¥ë‚¬ì–´ìš”', 'ë²„ë ¸ì–´ìš”', 'ê³ ì³¤ì–´ìš”', 'ìƒ€ì–´ìš”'], explanation: "The dialogue starts with Woody saying his air conditioner broke. 'ê³ ì¥ë‚˜ë‹¤' means 'to break down'.", eng: "Yesterday, Woody's air conditioner broke down.", wrongAnswerExplanations: { 'ë²„ë ¸ì–´ìš”': "'ë²„ë¦¬ë‹¤' means to throw away.", 'ê³ ì³¤ì–´ìš”': "'ê³ ì¹˜ë‹¤' means to fix, which is the opposite.", 'ìƒ€ì–´ìš”': "'ì‚¬ë‹¤' means to buy." } },
            { id: 2, parts: ["ìš°ë”” ì”¨ëŠ” ì§‘ì´ ë„ˆë¬´ ", " ë¬¼ê³ ê¸°ê°€ ë  ë»”í–ˆì–´ìš”."], blank: 'humid so', answer: 'ìŠµí•´ì„œ', bank: ['ì¶”ì›Œì„œ', 'ìŠµí•´ì„œ', 'ê±´ì¡°í•´ì„œ', 'ë”ì›Œì„œ'], explanation: "Woody says his house was so humid he almost became a fish. 'ìŠµí•˜ë‹¤' means 'to be humid'.", eng: "Woody's house was so humid he almost became a fish.", wrongAnswerExplanations: { 'ì¶”ì›Œì„œ': "Incorrect, it was hot and humid.", 'ê±´ì¡°í•´ì„œ': "This is the opposite of humid.", 'ë”ì›Œì„œ': "While related, 'humid' (ìŠµí•˜ë‹¤) was the specific word he used to exaggerate." } },
            { id: 3, parts: ["ìš°ë”” ì”¨ëŠ” ìì£¼ ", " ë§í•´ìš”."], blank: 'exaggeratedly', answer: 'ê³¼ì¥í•´ì„œ', bank: ['ì¡°ìš©íˆ', 'ì†”ì§í•˜ê²Œ', 'í™”ë‚˜ì„œ', 'ê³¼ì¥í•´ì„œ'], explanation: "Yuna accuses Woody of exaggerating. 'ê³¼ì¥í•´ì„œ ë§í•˜ë‹¤' means 'to speak exaggeratedly'.", eng: "Woody often speaks with exaggeration.", wrongAnswerExplanations: { 'ì¡°ìš©íˆ': "'ì¡°ìš©íˆ' means quietly.", 'ì†”ì§í•˜ê²Œ': "'ì†”ì§í•˜ê²Œ' means honestly.", 'í™”ë‚˜ì„œ': "'í™”ë‚˜ì„œ' means angrily." } },
            { id: 4, parts: ["ìœ ë‚˜ ì”¨ì—ê²Œ ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚˜ëŠ” ê²ƒì´ ë” ", "."], blank: 'terrible', answer: 'ë”ì°í•´ìš”', bank: ['ë”ì°í•´ìš”', 'ì¶”ì›Œìš”', 'ê²½í—˜í•´ìš”', 'ê´œì°®ë‹¤'], explanation: "Yuna believes a broken boiler in winter is more terrible. 'ë”ì°í•˜ë‹¤' means 'to be terrible/horrible'.", eng: "For Yuna, a broken boiler in winter is more terrible.", wrongAnswerExplanations: { 'ì¶”ì›Œìš”': "'ì¶¥ë‹¤' means cold.", 'ê²½í—˜í•´ìš”': "'ê²½í—˜í•˜ë‹¤' means to experience.", 'ê´œì°®ë‹¤': "'ê´œì°®ë‹¤' means okay." } },
            { id: 5, parts: ["ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚˜ë©´ ", " ìˆ˜ë„ ìˆì–´ìš”."], blank: 'freeze to death', answer: 'ì–¼ì–´ ì£½ì„', bank: ['ì–¼ì–´ ì£½ì„', 'ì›ƒê²¨ ì£½ì„', 'ë°°ê³ íŒŒ ì£½ì„', 'ë”ì›Œ ì£½ì„'], explanation: "Yuna's main concern is that one could freeze to death without a boiler. 'ì–¼ì–´ ì£½ë‹¤' means 'to freeze to death'.", eng: "If the boiler breaks in winter, you could freeze to death.", wrongAnswerExplanations: { 'ì›ƒê²¨ ì£½ì„': "This means 'to die of laughter'.", 'ë°°ê³ íŒŒ ì£½ì„': "This means 'to die of hunger'.", 'ë”ì›Œ ì£½ì„': "This means 'to die of heat'." } },
            { id: 6, parts: ["ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚˜ë©´ ë¬¼ì´ ", " ì•ˆ ë‚˜ì˜¬ ìˆ˜ë„ ìˆì–´ìš”."], blank: 'freeze and', answer: 'ì–¼ì–´ì„œ', bank: ['ì¶”ì›Œì„œ', 'ë“ì–´ì„œ', 'ë…¹ì•„ì„œ', 'ì–¼ì–´ì„œ'], explanation: "Yuna points out that without a boiler, the water can freeze and not come out. 'ì–¼ë‹¤' means 'to freeze'.", eng: "If the boiler breaks in winter, the water might freeze and not come out.", wrongAnswerExplanations: { 'ì¶”ì›Œì„œ': "This means 'because it's cold'.", 'ë“ì–´ì„œ': "This means 'boil and...'.", 'ë…¹ì•„ì„œ': "This means 'melt and...'." } },
            { id: 7, parts: ["ìš°ë”” ì”¨ëŠ” ê²¨ìš¸ì— ì¶”ìš°ë©´ ì˜·ì„ ", "."], blank: 'layers', answer: 'ê»´ì…ì–´ìš”', bank: ['ë²—ì–´ìš”', 'ê»´ì…ì–´ìš”', 'ë¹¨ì•„ìš”', 'ì‚¬ìš”'], explanation: "Woody's solution for the cold is to layer clothes. 'ê»´ì…ë‹¤' means 'to wear layers of clothes'.", eng: "When it's cold in winter, Woody layers his clothes.", wrongAnswerExplanations: { 'ë²—ì–´ìš”': "This means 'to take off'.", 'ë¹¨ì•„ìš”': "This means 'to wash'.", 'ì‚¬ìš”': "This means 'to buy'." } },
            { id: 8, parts: ["ìš°ë”” ì”¨ëŠ” ê²¨ìš¸ì— ", " ì£½ì–´ë„ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ë§ˆì…”ìš”."], blank: 'freeze', answer: 'ì–¼ì–´', bank: ['ì–¼ê³ ', 'ì–¼ìœ¼ë‹ˆê¹Œ', 'ì–¼ì–´', 'ì–¼ìœ¼ë©´ì„œ'], explanation: "The grammar pattern '-ì•„/ì–´ ì£½ì–´ë„' means 'even if I die from...'. 'ì–¼ë‹¤' conjugates to 'ì–¼ì–´'.", eng: "Woody drinks iced Americano in winter even if he freezes to death.", wrongAnswerExplanations: { 'ì–¼ê³ ': "Incorrect grammar for this context.", 'ì–¼ìœ¼ë‹ˆê¹Œ': "This means 'because it freezes'.", 'ì–¼ìœ¼ë©´ì„œ': "This means 'while freezing'." } },
            { id: 9, parts: ["ìš°ë”” ì”¨ëŠ” ì—ì–´ì»¨ì„ ", " ì¼ì£¼ì¼ ê¸°ë‹¤ë ¤ì•¼ í•´ìš”."], blank: 'to fix', answer: 'ê³ ì¹˜ë ¤ë©´', bank: ['ë§Œë“¤ë ¤ë©´', 'ë„ë ¤ë©´', 'ì‚¬ë ¤ë©´', 'ê³ ì¹˜ë ¤ë©´'], explanation: "The grammar pattern '-(ìœ¼)ë ¤ë©´' means 'if you intend to...'. Woody needs to wait a week to fix the A/C.", eng: "Woody has to wait a week to fix his air conditioner.", wrongAnswerExplanations: { 'ë§Œë“¤ë ¤ë©´': "This means 'if you intend to make'.", 'ë„ë ¤ë©´': "This means 'if you intend to turn off'.", 'ì‚¬ë ¤ë©´': "This means 'if you intend to buy'." } },
            { id: 10, parts: ["ìœ ë‚˜ ì”¨ëŠ” â€œë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚˜ë©´, ê·¸ ë‹¤ìŒ ë‚  ", " ì™€ìš”â€ë¼ê³  ë§í–ˆì–´ìš”."], blank: 'to fix (purpose)', answer: 'ê³ ì¹˜ëŸ¬', bank: ['ê³ ì¹˜ëŸ¬', 'ê³ ì¹˜ëŠ”ë°', 'ê³ ì³ì„œ', 'ê³ ì¹˜ë ¤ë©´'], explanation: "The grammar pattern '-(ìœ¼)ëŸ¬ ì˜¤ë‹¤/ê°€ë‹¤' means 'to come/go in order to do...'. The repair person comes to fix it.", eng: "Yuna said, 'If the boiler breaks, they come to fix it the next day.'", wrongAnswerExplanations: { 'ê³ ì¹˜ëŠ”ë°': "This means 'fixing it, but...'.", 'ê³ ì³ì„œ': "This means 'fix it and then...'.", 'ê³ ì¹˜ë ¤ë©´': "This means 'if you intend to fix it'." } }
        ];

        const SCRIPT_DATA = [
            { id: 's1', speaker: 'ìš°ë””', kor: 'ì•ˆë…•í•˜ì„¸ìš”! <ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”> íŒŸìºìŠ¤íŠ¸ì˜ˆìš”.', time: [4.679, 8.906], eng: "Hello! This is the <Let's Talk About This Topic> podcast." },
            { id: 's2', speaker: 'ìš°ë””', kor: 'ì €ëŠ” ìš°ë””ì˜ˆìš”.', time: [8.906, 10.190], eng: "I'm Woody." },
            { id: 's3', speaker: 'ìœ ë‚˜', kor: 'ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” ìœ ë‚˜ì˜ˆìš”.', time: [10.284, 12.834], eng: "Hello! I'm Yuna." },
            { id: 's4', speaker: 'ìš°ë””', kor: 'ìœ ë‚˜ ì”¨, ì˜¤ëŠ˜ì€ ì •ë§ ì¤‘ìš”í•œ ì´ì•¼ê¸°ë¥¼ í•´ì•¼ í•´ìš”.', time: [13.042, 16.699], eng: "Yuna, I have to talk about something really important today." },
            { id: 's5', speaker: 'ìœ ë‚˜', kor: 'ë­ê°€ ì¤‘ìš”í•´ìš”?', time: [16.763, 18.192], eng: "What is important?" },
            { id: 's6', speaker: 'ìš°ë””', kor: 'ë“¤ì–´ë³´ì„¸ìš”.', time: [18.640, 19.849], eng: "Listen." },
            { id: 's7', speaker: 'ìš°ë””', kor: 'ì–´ì œ ìš°ë¦¬ ì§‘ ì—ì–´ì»¨ì´ ê³ ì¥ë‚¬ì–´ìš”!', time: [19.939, 22.379], eng: "My air conditioner broke down yesterday!" },
            { id: 's8', speaker: 'ìš°ë””', kor: 'â€˜ê³ ì¥ë‚˜ë‹¤â€™ëŠ” â€˜ì“¸ ìˆ˜ ì—†ë‹¤â€™ë¼ëŠ” ëœ»ì´ì—ìš”.', time: [22.500, 25.627], eng: "'Go-jang-na-da' means 'cannot be used'." },
            { id: 's9', speaker: 'ìœ ë‚˜', kor: 'ê·¸ë˜ì„œìš”?', time: [25.724, 26.628], eng: "So?" },
            { id: 's10', speaker: 'ìš°ë””', kor: 'ê·¸ë˜ì„œìš”????!', time: [27.000, 28.303], eng: "So????!" },
            { id: 's11', speaker: 'ìš°ë””', kor: 'ìœ ë‚˜ ì”¨, ì € ì–´ì œ ì£½ì„ ë»”í–ˆì–´ìš”!', time: [28.600, 31.709], eng: "Yuna, I almost died yesterday!" },
            { id: 's12', speaker: 'ìœ ë‚˜', kor: 'ğŸ¤£ ìš°ë”” ì”¨ëŠ” í•­ìƒ ì£½ì„ ë»”í•´ìš”.', time: [31.774, 35.697], eng: "ğŸ¤£ Woody, you almost die all the time." },
            { id: 's13', speaker: 'ìœ ë‚˜', kor: 'í•˜ì§€ë§Œ í•œë²ˆë„ ì§„ì§œ ì£½ì§€ ì•Šì•˜ì–´ìš”.', time: [35.894, 39.101], eng: "But you never actually died." },
            { id: 's14', speaker: 'ìš°ë””', kor: 'ì´ë²ˆì—” ì§„ì§œì˜ˆìš”!', time: [39.300, 41.007], eng: "This time it's real!" },
            { id: 's15', speaker: 'ìš°ë””', kor: 'ì§‘ì´ ë„ˆë¬´ ìŠµí•´ì„œ ë¬¼ê³ ê¸°ê°€ ë  ë»”í–ˆì–´ìš”!', time: [41.180, 45.177], eng: "It was so humid in the house, I almost became a fish!" },
            { id: 's16', speaker: 'ìš°ë””', kor: 'â€˜ìŠµí•˜ë‹¤â€™ëŠ” â€˜ì –ì€ ê²ƒ ê°™ë‹¤â€™ëŠ” ëœ»ì´ì—ìš”.', time: [45.302, 48.718], eng: "'Seup-ha-da' means 'it feels wet'." },
            { id: 's17', speaker: 'ìœ ë‚˜', kor: 'ë¬¼ê³ ê¸°ìš”? ìš°ë”” ì”¨ëŠ” í•­ìƒ ê³¼ì¥í•´ì„œ ë§í•´ìš”.', time: [48.815, 53.106], eng: "A fish? You always exaggerate, Woody." },
            { id: 's18', speaker: 'ìœ ë‚˜', kor: 'ê³¼ì¥í•˜ë‹¤ëŠ” â€˜ì‚¬ì‹¤ì„ ë§í•˜ì§€ë§Œ ì¡°ê¸ˆ ê±°ì§“ë§ì„ í•˜ë‹¤â€™ë¼ëŠ” ëœ»ì´ì—ìš”.', time: [53.241, 58.901], eng: "'Gwa-jang-ha-da' means 'telling the truth but lying a little'." },
            { id: 's19', speaker: 'ìš°ë””', kor: 'ìœ ë‚˜ ì”¨, ì—ì–´ì»¨ì´ ê³ ì¥ë‚œ ì  ì—†ì£ ?', time: [59.100, 61.954], eng: "Yuna, your air conditioner has never broken down, has it?" },
            { id: 's20', speaker: 'ìœ ë‚˜', kor: 'ì €ë„ ê²½í—˜í•´ ë´¤ì–´ìš”.', time: [62.051, 63.886], eng: "I've experienced it too." },
            { id: 's21', speaker: 'ìœ ë‚˜', kor: 'ì‘ë…„ ì—¬ë¦„ì— ì—ì–´ì»¨ì´ ê³ ì¥ë‚¬ê³ , ì‹¬ì§€ì–´ ê²¨ìš¸ì— ë³´ì¼ëŸ¬ë„ ê³ ì¥ë‚¬ì–´ìš”.', time: [63.972, 69.668], eng: "Last summer, the air conditioner broke, and even the boiler broke in the winter." },
            { id: 's22', speaker: 'ìš°ë””', kor: 'ì–´ë–¤ ìƒí™©ì´ ë” ë”ì°í–ˆì–´ìš”?', time: [69.718, 72.223], eng: "Which situation was more terrible?" },
            { id: 's23', speaker: 'ìš°ë””', kor: 'ì—¬ë¦„ì— ì—ì–´ì»¨ì´ ê³ ì¥ë‚¬ì„ ë•Œì˜ˆìš”?', time: [72.591, 74.784], eng: "Was it when the air conditioner broke in the summer?" },
            { id: 's24', speaker: 'ìš°ë””', kor: 'ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚¬ì„ ë•Œì˜ˆìš”?', time: [74.929, 77.445], eng: "Was it when the boiler broke in the winter?" },
            { id: 's25', speaker: 'ìœ ë‚˜', kor: 'ë”ì°í•˜ë‹¤ëŠ” \'ë§¤ìš° ë‚˜ì˜ê³  ë¬´ì„­ë‹¤\'ë¼ëŠ” ëœ»ì´ì£ ?', time: [77.566, 82.650], eng: "'Kkeum-jjik-ha-da' means 'very bad and scary', right?" },
            { id: 's26', speaker: 'ìœ ë‚˜', kor: 'ë‹¹ì—°íˆ ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚¬ì„ ë•Œ ë” í˜ë“¤ì—ˆì–´ìš”.', time: [82.878, 87.034], eng: "Of course, it was harder when the boiler broke in the winter." },
            { id: 's27', speaker: 'ìš°ë””', kor: 'ì—ì´, ë§ë„ ì•ˆ ë¼ìš”!', time: [87.300, 89.245], eng: "Hey, that makes no sense!" },
            { id: 's28', speaker: 'ìš°ë””', kor: 'ì—¬ë¦„ì— ì—ì–´ì»¨ ê³ ì¥ì´ 100ë°° ë” í˜ë“¤ì–´ìš”.', time: [89.330, 92.001], eng: "A broken air conditioner in summer is 100 times harder." },
            { id: 's29', speaker: 'ìœ ë‚˜', kor: 'ë˜ ê³¼ì¥í•´ì„œ ë§í•˜ë„¤ìš”.', time: [92.074, 93.888], eng: "You're exaggerating again." },
            { id: 's30', speaker: 'ìœ ë‚˜', kor: 'ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ì—†ìœ¼ë©´ ì •ë§ ì–¼ì–´ ì£½ì„ ìˆ˜ë„ ìˆì–´ìš”.', time: [93.949, 97.895], eng: "Without a boiler in winter, you could really freeze to death." },
            { id: 's31', speaker: 'ìœ ë‚˜', kor: 'â€˜ì–¼ì–´ ì£½ë‹¤â€™ëŠ” â€˜ë„ˆë¬´ ì¶”ì›Œì„œ ì£½ëŠ”ë‹¤â€™ëŠ” ëœ»ì´ì—ìš”.', time: [98.157, 103.062], eng: "'Eol-eo-juk-da' means 'dying because it's too cold'." },
            { id: 's32', speaker: 'ìœ ë‚˜', kor: 'ì •ë§ ìœ„í—˜í•´ìš”.', time: [103.135, 104.668], eng: "It's really dangerous." },
            { id: 's33', speaker: 'ìš°ë””', kor: 'ì•„ë‹ˆì—ìš”. ì—¬ë¦„ì— ì—ì–´ì»¨ì´ ì—†ìœ¼ë©´, ë…¹ì•„ìš”.', time: [104.854, 108.454], eng: "No. If there's no air conditioner in the summer, you melt." },
            { id: 's34', speaker: 'ìœ ë‚˜', kor: 'ìš°ë”” ì”¨ëŠ” ì•„ì´ìŠ¤í¬ë¦¼ì´ì—ìš”? ì–´ë–»ê²Œ ì‚¬ëŒì´ ë…¹ì•„ìš”?', time: [108.515, 112.621], eng: "Are you an ice cream, Woody? How can a person melt?" },
            { id: 's35', speaker: 'ìš°ë””', kor: 'ì§„ì§œì˜ˆìš”! ë„ˆë¬´ ë”ì›Œì„œ ì§‘ì—ì„œ ì˜·ë„ ë‹¤ ë²—ì—ˆì–´ìš”!', time: [112.879, 118.275], eng: "It's true! It was so hot I took off all my clothes at home!" },
            { id: 's36', speaker: 'ìœ ë‚˜', kor: 'ìš°ë”” ì”¨! ê·¸ê±´ TMIì˜ˆìš”.', time: [118.500, 121.499], eng: "Woody! That's TMI." },
            { id: 's37', speaker: 'ìš°ë””', kor: 'ì•„ë¬´íŠ¼ ê²¨ìš¸ì—ëŠ” ì˜·ì„ ê»´ì…ì„ ìˆ˜ ìˆì–´ìš”.', time: [121.900, 124.969], eng: "Anyway, you can layer clothes in the winter." },
            { id: 's38', speaker: 'ìš°ë””', kor: 'ê·¸ëŸ¬ë©´ ì–¼ì–´ ì£½ì§€ ì•Šì•„ìš”.', time: [125.042, 126.891], eng: "Then you won't freeze to death." },
            { id: 's39', speaker: 'ìœ ë‚˜', kor: 'â€˜ê»´ì…ë‹¤â€™ëŠ” ì˜·ì„ ì—¬ëŸ¬ ê°œ ì…ëŠ” ê±°ì˜ˆìš”.', time: [127.000, 131.079], eng: "'Kkyeo-ip-da' means wearing multiple layers of clothes." },
            { id: 's40', speaker: 'ìœ ë‚˜', kor: 'ê·¸ëŸ°ë° ìš°ë”” ì”¨ëŠ” ê²¨ìš¸ì— ì•ˆ ì”»ì–´ìš”?', time: [131.322, 134.382], eng: "But don't you wash in the winter, Woody?" },
            { id: 's41', speaker: 'ìœ ë‚˜', kor: 'ë³´ì¼ëŸ¬ê°€ ì—†ìœ¼ë©´ ë¬¼ì´ ì–¼ì–´ì„œ ì•ˆ ë‚˜ì˜¬ ìˆ˜ë„ ìˆì–´ìš”.', time: [134.800, 139.134], eng: "If there is no boiler, the water might freeze and not come out." },
            { id: 's42', speaker: 'ìš°ë””', kor: 'ë¬¼ì´ ì–¼ì–´ìš”?', time: [139.566, 141.041], eng: "The water freezes?" },
            { id: 's43', speaker: 'ìš°ë””', kor: 'ê·¸ëŸ¼ ì§‘ì—ì„œ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.', time: [141.138, 144.397], eng: "Then you can make iced americano at home." },
            { id: 's44', speaker: 'ìœ ë‚˜', kor: 'ìš°ë”” ì”¨, ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•´ìš”!', time: [144.458, 148.734], eng: "Woody, think before you speak!" },
            { id: 's45', speaker: 'ìš°ë””', kor: 'ìœ ë‚˜ ì”¨ëŠ” ê²¨ìš¸ì— ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ë§ˆì‹œì–ì•„ìš”. ë§ì£ ?', time: [149.000, 152.595], eng: "You drink iced americano in winter, Yuna. Right?" },
            { id: 's46', speaker: 'ìš°ë””', kor: 'ì €ë„ ê²¨ìš¸ì— ì–¼ì–´ ì£½ì–´ë„ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ë§ˆì…”ìš”.', time: [152.705, 156.231], eng: "I also drink iced americano even if I freeze to death in winter." },
            { id: 's47', speaker: 'ìœ ë‚˜', kor: 'ğŸ˜†ì•Œê² ì–´ìš”.', time: [156.300, 158.681], eng: "ğŸ˜† Okay." },
            { id: 's48', speaker: 'ìœ ë‚˜', kor: 'ê·¸ëŸ°ë° ìš°ë”” ì”¨, ì—ì–´ì»¨ ê³ ì³¤ì–´ìš”?', time: [158.887, 162.445], eng: "By the way, Woody, did you fix the air conditioner?" },
            { id: 's49', speaker: 'ìœ ë‚˜', kor: 'â€˜ê³ ì¹˜ë‹¤â€™ëŠ” â€˜ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“¤ë‹¤â€™ë¼ëŠ” ëœ»ì´ì—ìš”.', time: [162.773, 167.254], eng: "'Go-chi-da' means 'to make it usable again'." },
            { id: 's50', speaker: 'ìš°ë””', kor: 'ì•„ì§ ëª» í–ˆì–´ìš”.', time: [167.400, 169.365], eng: "I haven't done it yet." },
            { id: 's51', speaker: 'ìš°ë””', kor: 'ì¼ì£¼ì¼ ê¸°ë‹¤ë ¤ì•¼ í•´ìš”.', time: [169.450, 171.085], eng: "I have to wait a week." },
            { id: 's52', speaker: 'ìœ ë‚˜', kor: 'ì¼ì£¼ì¼ì´ìš”? ì•ˆ ëë„¤ìš”.', time: [171.149, 173.604], eng: "A week? That's too bad." },
            { id: 's53', speaker: 'ìœ ë‚˜', kor: 'ê·¸ëŸ°ë° ë³´ì¼ëŸ¬ê°€ ê³ ì¥ë‚˜ë©´, ê·¸ ë‹¤ìŒ ë‚  ê³ ì¹˜ëŸ¬ ì™€ìš”.', time: [173.927, 178.334], eng: "But if the boiler breaks, they come to fix it the next day." },
            { id: 's54', speaker: 'ìš°ë””', kor: 'ì •ë§ìš”?ğŸ˜­', time: [178.500, 179.568], eng: "Really?ğŸ˜­" },
            { id: 's55', speaker: 'ìœ ë‚˜', kor: 'ë„¤, ë³´ì¼ëŸ¬ê°€ ë” ì¤‘ìš”í•˜ë‹ˆê¹Œìš”.ğŸ˜', time: [179.725, 183.415], eng: "Yes, because the boiler is more important.ğŸ˜" },
            { id: 's56', speaker: 'ìœ ë‚˜', kor: 'ê·¸ëŸ¼ ì˜¤ëŠ˜ ë°°ìš´ ë‹¨ì–´ ì •ë¦¬í•´ ë³¼ê¹Œìš”?', time: [183.768, 186.512], eng: "Then shall we review the words we learned today?" },
            { id: 's57', speaker: 'ìš°ë””', kor: 'ë„¤ğŸ˜­', time: [186.584, 187.813], eng: "YesğŸ˜­" },
            { id: 's58', speaker: 'ìœ ë‚˜', kor: 'âˆ™ê³ ì¥ë‚˜ë‹¤ = ì“¸ ìˆ˜ ì—†ë‹¤', time: [188.700, 192.144], eng: "âˆ™Go-jang-na-da = Cannot be used" },
            { id: 's59', speaker: 'ìœ ë‚˜', kor: 'âˆ™ì£½ì„ ë»”í–ˆì–´ìš” = ì£½ì„ ìˆ˜ ìˆì§€ë§Œ, ì§„ì§œ ì£½ì§€ ì•Šë‹¤', time: [192.699, 199.216], eng: "âˆ™Juk-eul ppeon-haess-eo-yo = Could have died, but didn't really die" },
            { id: 's60', speaker: 'ìœ ë‚˜', kor: 'âˆ™ìŠµí•˜ë‹¤ = ì –ì€ ê²ƒ ê°™ë‹¤', time: [199.653, 203.196], eng: "âˆ™Seup-ha-da = Feels wet" },
            { id: 's61', speaker: 'ìœ ë‚˜', kor: 'âˆ™ê³¼ì¥í•˜ë‹¤ = ì‚¬ì‹¤ì„ ë§í•˜ì§€ë§Œ ì¡°ê¸ˆ ê±°ì§“ë§ì„ í•˜ë‹¤', time: [203.524, 208.755], eng: "âˆ™Gwa-jang-ha-da = Telling the truth but lying a little" },
            { id: 's62', speaker: 'ìš°ë””', kor: 'âˆ™ë”ì°í•˜ë‹¤ = ë§¤ìš° ë‚˜ì˜ê³  ë¬´ì„­ë‹¤', time: [209.566, 213.940], eng: "âˆ™Kkeum-jjik-ha-da = Very bad and scary" },
            { id: 's63', speaker: 'ìš°ë””', kor: 'âˆ™ì–¼ì–´ ì£½ë‹¤ = ë„ˆë¬´ ì¶”ì›Œì„œ ì£½ë‹¤', time: [214.110, 217.741], eng: "âˆ™Eol-eo juk-da = Dying because it's too cold" },
            { id: 's64', speaker: 'ìš°ë””', kor: 'âˆ™ê»´ì…ë‹¤ = ì˜·ì„ ì—¬ëŸ¬ ê°œ ì…ë‹¤', time: [218.045, 221.915], eng: "âˆ™Kkyeo-ip-da = Wearing multiple layers of clothes" },
            { id: 's65', speaker: 'ìš°ë””', kor: 'âˆ™ê³ ì¹˜ë‹¤ = ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“¤ë‹¤', time: [222.540, 226.468], eng: "âˆ™Go-chi-da = Making it usable again" },
            { id: 's66', speaker: 'ìœ ë‚˜', kor: 'ì—¬ëŸ¬ë¶„ì€ ì–´ë–»ê²Œ ìƒê°í•´ìš”?', time: [226.614, 228.432], eng: "What do you think?" },
            { id: 's67', speaker: 'ìš°ë””', kor: '\'íŒ€ ìš°ë””\'ì¸ì§€ \'íŒ€ ìœ ë‚˜\'ì¸ì§€ ì•Œë ¤ì£¼ì„¸ìš”!', time: [228.541, 231.440], eng: "Let us know if you are 'Team Woody' or 'Team Yuna'!" },
            { id: 's68', speaker: 'ìš°ë””', kor: 'ë¬¼ë¡  íŒ€ ìš°ë””ê°€ ë§ì„ ê±°ì˜ˆìš”.', time: [231.501, 234.610], eng: "Of course, there will be many Team Woody." },
            { id: 's69', speaker: 'ìœ ë‚˜', kor: ' ê·¸ê±´ ìš°ë”” ì”¨ ë°”ëŒì´ì£ .', time: [234.903, 237.503], eng: "That's Woody's wish." },
            { id: 's70', speaker: 'ìœ ë‚˜', kor: 'ê·¸ëŸ¼ ì˜¤ëŠ˜ ì—¬ê¸°ê¹Œì§€ì˜ˆìš”. ì•ˆë…•íˆ ê³„ì„¸ìš”.', time: [237.600, 240.152], eng: "That's it for today. Goodbye." },
            { id: 's71', speaker: 'ìš°ë””', kor: 'ê·¸ëŸ¼ ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€ì˜ˆìš”. ì•ˆë…•íˆ ê³„ì„¸ìš”!', time: [240.283, 242.916], eng: "That's it for today. Goodbye!" }
        ];

        const DISCUSS_DATA = [
            { num: 1, kor: "íŒ€ ìš°ë”” â€œì—¬ë¦„ì— ì—ì–´ì»¨ ê³ ì¥â€ VS íŒ€ ìœ ë‚˜ â€œê²¨ìš¸ì— ë³´ì¼ëŸ¬ ê³ ì¥â€. ì—¬ëŸ¬ë¶„ì—ê²Œ ì–´ë–¤ ê²ƒì´ ë” <span class='text-rose-500 font-bold'>ë”ì°í•´ìš”</span>?", eng: "Team Woody 'Broken A/C in Summer' VS Team Yuna 'Broken Boiler in Winter'. Which is more terrible for you?", vocab: [{ term: "ë”ì°í•˜ë‹¤", meaning: "to be terrible, horrible", context: "ìš°ë””: ì–´ë–¤ ìƒí™©ì´ ë” ë”ì°í–ˆì–´ìš”?", context_eng: "Woody: Which situation was more terrible?" }] },
            { num: 2, kor: "ì—¬ëŸ¬ë¶„ì€ ì—¬ë¦„ì— ì—ì–´ì»¨ì´ <span class='text-rose-500 font-bold'>ê³ ì¥ë‚œ</span> ì ì´ ìˆì–´ìš”? ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ <span class='text-rose-500 font-bold'>ê³ ì¥ë‚œ</span> ì ì´ ìˆì–´ìš”?", eng: "Have you ever had your A/C break down in the summer? Or your boiler break down in the winter?", vocab: [{ term: "ê³ ì¥ë‚˜ë‹¤", meaning: "to break down, to malfunction", context: "ìš°ë””: ì–´ì œ ìš°ë¦¬ ì§‘ ì—ì–´ì»¨ì´ ê³ ì¥ë‚¬ì–´ìš”!", context_eng: "Woody: My air conditioner broke down yesterday!" }, { term: "-ã„´/ì€ ì  (ì—†ë‹¤/ìˆë‹¤)", meaning: "to have (never/ever) done...", context: "ìš°ë””: ìœ ë‚˜ ì”¨, ì—ì–´ì»¨ì´ ê³ ì¥ë‚œ ì  ì—†ì£ ?", context_eng: "Yuna, you've never had an A/C break down, have you?" }] },
            { num: 3, kor: "ì—¬ëŸ¬ë¶„ ë‚˜ë¼ì—ì„œ ì—ì–´ì»¨ì´ <span class='text-rose-500 font-bold'>ê³ ì¥ë‚˜ë©´</span> ë¹¨ë¦¬ <span class='text-rose-500 font-bold'>ê³ ì¹˜ëŸ¬</span> ì™€ìš”?", eng: "In your country, if an air conditioner breaks down, do they come to fix it quickly?", vocab: [{ term: "ê³ ì¥ë‚˜ë‹¤", meaning: "to break down", context: "ìš°ë””: ì–´ì œ ìš°ë¦¬ ì§‘ ì—ì–´ì»¨ì´ ê³ ì¥ë‚¬ì–´ìš”!", context_eng: "Woody: My air conditioner broke down yesterday!" }, { term: "ê³ ì¹˜ë‹¤", meaning: "to fix", context: "ìœ ë‚˜: ì—ì–´ì»¨ ê³ ì³¤ì–´ìš”?", context_eng: "Yuna: Did you fix your A/C?" }] },
            { num: 4, kor: "ì—¬ëŸ¬ë¶„ì€ ì—¬ë¦„ì— ë”ì›Œ <span class='text-rose-500 font-bold'>ì£½ì„ ë»”í–ˆì–´ìš”</span>? ê²¨ìš¸ì— <span class='text-rose-500 font-bold'>ì–¼ì–´ ì£½ì„ ë»”í–ˆì–´ìš”</span>? ë˜ ì–¸ì œ <span class='text-rose-500 font-bold'>ì£½ì„ ë»”í–ˆì–´ìš”</span>?", eng: "Have you almost died from the heat in summer? Almost died from the cold in winter? When else have you almost died?", vocab: [{ term: "ì£½ì„ ë»”í•˜ë‹¤", meaning: "to almost die", context: "ìš°ë””: ì € ì–´ì œ ì£½ì„ ë»”í–ˆì–´ìš”!", context_eng: "Woody: I almost died yesterday!" }, { term: "ì–¼ì–´ ì£½ë‹¤", meaning: "to freeze to death", context: "ìœ ë‚˜: ê²¨ìš¸ì— ë³´ì¼ëŸ¬ê°€ ì—†ìœ¼ë©´ ì •ë§ ì–¼ì–´ ì£½ì„ ìˆ˜ë„ ìˆì–´ìš”.", context_eng: "Yuna: If you don't have a boiler in winter, you could really freeze to death." }] },
            { num: 5, kor: "ì—¬ëŸ¬ë¶„ì€ ì—¬ë¦„ì— ì§‘ì—ì„œ ë„ˆë¬´ <span class='text-rose-500 font-bold'>ìŠµí•˜ë©´</span>, ì–´ë–»ê²Œ í•´ìš”?", eng: "What do you do when your house is too humid in the summer?", vocab: [{ term: "ìŠµí•˜ë‹¤", meaning: "to be humid", context: "ìš°ë””: ì§‘ì´ ë„ˆë¬´ ìŠµí•´ì„œ ë¬¼ê³ ê¸°ê°€ ë  ë»”í–ˆì–´ìš”!", context_eng: "Woody: The house was so humid I almost turned into a fish!" }] },
            { num: 6, kor: "ì—¬ëŸ¬ë¶„ì€ ê²¨ìš¸ì— ì¶”ìš°ë©´ ì˜·ì„ ëª‡ ê°œ <span class='text-rose-500 font-bold'>ê»´ì…ì–´ìš”</span>?", eng: "How many layers of clothes do you wear when it's cold in the winter?", vocab: [{ term: "ê»´ì…ë‹¤", meaning: "to layer clothes", context: "ìš°ë””: ì•„ë¬´íŠ¼ ê²¨ìš¸ì—ëŠ” ì˜·ì„ ê»´ì…ì„ ìˆ˜ ìˆì–´ìš”.", context_eng: "Woody: Anyway, in the winter you can wear layers of clothes." }] },
            { num: 7, kor: "ì—¬ëŸ¬ë¶„ë„ ê²¨ìš¸ì— â€œ<span class='text-rose-500 font-bold'>ì–¼ì–´ ì£½ì–´ë„</span> ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸â€ë¥¼ ë§ˆì…”ìš”? ì—¬ë¦„ì´ë‚˜ ê²¨ìš¸ì— í•­ìƒ ì¢‹ì•„í•˜ëŠ” ìŒì‹ì´ ë­ì˜ˆìš”?", eng: "Do you also drink 'Iced Americano even if I freeze to death' in the winter? What's a food you always like in summer or winter?", vocab: [{ term: "ì–¼ì–´ ì£½ì–´ë„", meaning: "even if I freeze to death", context: "ìš°ë””: ì €ë„ ê²¨ìš¸ì— ì–¼ì–´ ì£½ì–´ë„ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ë§ˆì…”ìš”.", context_eng: "Woody: I also drink iced Americanos in winter even if I freeze to death." }] },
            { num: 8, kor: "ì—¬ëŸ¬ë¶„ì—ê²Œë„ <span class='text-rose-500 font-bold'>ê³¼ì¥í•´ì„œ</span> ë§í•˜ëŠ” ì¹œêµ¬ê°€ ìˆì–´ìš”? ê·¸ ì¹œêµ¬ëŠ” ë³´í†µ ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ í•´ìš”?", eng: "Do you also have a friend who exaggerates? What kind of stories do they usually tell?", vocab: [{ term: "ê³¼ì¥í•˜ë‹¤", meaning: "to exaggerate", context: "ìœ ë‚˜: ìš°ë”” ì”¨ëŠ” í•­ìƒ ê³¼ì¥í•´ì„œ ë§í•´ìš”.", context_eng: "Yuna: Woody, you always exaggerate." }] },
            { num: 9, kor: "ì—¬ëŸ¬ë¶„ì€ ì¹œêµ¬ê°€ <span class='text-rose-500 font-bold'>TMI</span>(ì•Œê³  ì‹¶ì§€ ì•Šì€ ì´ì•¼ê¸°)ë¥¼ ë§í•˜ë©´ ì–´ë–»ê²Œ í•´ìš”?", eng: "What do you do when a friend tells you TMI (stories you don't want to know)?", vocab: [{ term: "TMI", meaning: "Too Much Information", context: "ìœ ë‚˜: ìš°ë”” ì”¨! ê·¸ê±´ TMIì˜ˆìš”.", context_eng: "Yuna: Woody! That's TMI." }] },
            { num: 10, kor: "ì—¬ëŸ¬ë¶„ì€ <span class='text-rose-500 font-bold'>ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•´ìš”</span>?", eng: "Do you think before you speak?", vocab: [{ term: "ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•˜ë‹¤", meaning: "to think before speaking", context: "ìœ ë‚˜: ìš°ë”” ì”¨, ë§í•˜ê¸° ì „ì— ìƒê°ì„ í•´ìš”!", context_eng: "Woody, think before you speak!" }] }
        ];

        const LEVEL_STYLES = { "A1": "bg-lime-50 text-lime-600 border-lime-100", "A1+": "bg-lime-50 text-lime-600 border-lime-100", "A2": "bg-green-50 text-green-600 border-green-100", "A2+": "bg-green-50 text-green-600 border-green-100", "B1": "bg-sky-50 text-sky-600 border-sky-100", "B1+": "bg-sky-50 text-sky-600 border-sky-100", "B2": "bg-blue-50 text-blue-600 border-blue-100", "B2+": "bg-blue-50 text-blue-600 border-blue-100", "C1": "bg-violet-50 text-violet-600 border-violet-100", "C1+": "bg-violet-50 text-violet-600 border-violet-100", "C2": "bg-violet-50 text-violet-600 border-violet-100" };
        const getLevelTheme = (l) => { const c = l.charAt(0); if(c==='A')return l==='A1'||l==='A1+'?'lime':'green'; if(c==='B')return l==='B1'||l==='B1+'?'sky':'blue'; return 'violet'; };

        const HomeIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="2" y="3" width="20" height="14" rx="2" ry="2" /><path d="M8 21h8" /><path d="M12 17v4" /></svg>);
        const LearnIcon = ({ className, filled }) => (<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="2" y="4" width="20" height="16" rx="4" fill={filled ? "currentColor" : "none"} /><polygon points="10 8 16 12 10 16 10 8" stroke={filled ? "#fff" : "currentColor"} fill={filled ? "#fff" : "none"} /></svg>);
        const VocabIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" className={className}><path d="M3.5 12.5 12.5 3.5h6a2 2 0 0 1 2 2v6l-9 9a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8Z" stroke="currentColor" strokeWidth="1.8"/><path d="M16.5 7.5h.01" stroke="currentColor" strokeWidth="3.2" strokeLinecap="round"/></svg>);
        const QuizIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" className={className}><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" strokeWidth="1.8"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"/><path d="M12 17h.01" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"/></svg>);
        const DiscussIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" className={className}><path d="M3 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3h-2v3l-4.5-3H6a3 3 0 0 1-3-3V6Z" stroke="currentColor" strokeWidth="1.8" strokeLinejoin="round"/><path d="M7 8h10M7 12h7" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round"/></svg>);
        const LineIcon = ({ d, className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d={d} /></svg>);
        const PlayIconLine = (props) => <LineIcon {...props} d="M5 3l14 9-14 9V3z" />;
        const PlayIconSolid = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M8 5v14l11-7z" /></svg>);
        const PauseIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" /></svg>);
        const OpenBookSolidIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 6 C2 3 8 2 12 6 C16 2 22 3 22 6 V20 C22 17 16 16 12 20 C8 16 2 17 2 20 Z" /><path d="M12 6 V20" /><path d="M4.5 15 L7 9 L9.5 15" strokeWidth="1.5" /><path d="M5.5 13 H8.5" strokeWidth="1.5" /><path d="M15 10 H19" strokeWidth="1.5" /><path d="M15 13 H19" strokeWidth="1.5" /><path d="M15 16 H18" strokeWidth="1.5" /></svg>);
        const TranslateIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M12.87 15.07l-2.54-2.51.03-.03A17.52 17.52 0 0014.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.09-.02.67-.02zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z" /></svg>);
        const ExternalLinkIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" /><polyline points="15 3 21 3 21 9" /><line x1="10" y1="14" x2="21" y2="3" /></svg>);
        const ChevronLeft = ({ className }) => <LineIcon d="m15 18-6-6 6-6" className={className}/>;
        const ChevronRight = ({ className }) => <LineIcon d="m9 18 6-6-6-6" className={className}/>;
        const SpeedSolidIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z"/><path d="M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"/></svg>);
        const SparklesIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 00-1.423 1.423z" /></svg>);
        const RewindIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="11 19 2 12 11 5 11 19" /><polygon points="22 19 13 12 22 5 22 19" /></svg>);
        const ForwardIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 19 22 12 13 5 13 19" /><polygon points="2 19 11 12 2 5 2 19" /></svg>);
        const PlayCircleIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className={className}><circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="1.8" /><path d="M10 8L16 12L10 16V8Z" fill="currentColor" /></svg>);

        const Sidebar = ({ activeTab, setActiveTab, isCollapsed, toggleSidebar, userLevel, themeColor }) => {
            const menus = [
                { id: 'home', label: 'ì‹œì‘ í˜ì´ì§€', subLabel: 'Home Page', icon: HomeIcon },
                { id: 'learn', label: 'ë™ì˜ìƒ ìë£Œ', subLabel: 'Video Resources', icon: LearnIcon },
                { id: 'vocab', label: 'í•µì‹¬ ì–´íœ˜', subLabel: 'Key Vocabulary', icon: VocabIcon },
                { id: 'quiz', label: 'ë‚´ìš© í™•ì¸ í€´ì¦ˆ', subLabel: 'Comprehension Quiz', icon: QuizIcon },
                { id: 'discuss', label: 'ìƒê°í•´ ë³´ê¸°', subLabel: 'Food For Thought', icon: DiscussIcon },
            ];
            const getLevelColor = (code) => { if (LEVEL_STYLES[code]) return LEVEL_STYLES[code]; const base = code.substring(0, 2); return LEVEL_STYLES[base] || "bg-gray-50 text-slate-600 border-gray-100"; };
            const currentStyle = getLevelColor(userLevel);
            const bgClass = currentStyle.split(' ')[0];
            const textClass = currentStyle.split(' ')[1];
            const [tooltip, setTooltip] = useState({ show: false, x: 0, y: 0, info: null });
            const handleLevelTextEnter = (e) => { const rect = e.target.getBoundingClientRect(); setTooltip({ show: true, x: rect.right, y: rect.top, info: LEVEL_DEFINITIONS[userLevel] }); };
            const handleLevelTextLeave = () => { setTooltip(prev => ({ ...prev, show: false })); };
            const sidebarFontSize = isCollapsed ? '1rem' : '1.15rem';
            const sidebarWidth = isCollapsed ? '5.5rem' : '18.4rem';

            return (
                <aside style={{ fontSize: sidebarFontSize, width: sidebarWidth }} className={`bg-white border-r border-gray-200 fixed h-full hidden lg:flex flex-col z-50 transition-all duration-300 ease-in-out font-basic`}>
                    <div className={`p-[1.5em] flex items-center gap-[0.75em] relative ${isCollapsed ? 'justify-center px-0' : ''}`}>
                        <img src="https://raw.githubusercontent.com/openkoreanlearninglab/hub/refs/heads/main/OpenKoreanLearningLab_Logo.jpeg" alt="Logo" className={`rounded-2xl shadow-lg shrink-0 transition-all duration-300 object-cover ${isCollapsed ? 'w-[3em] h-[3em]' : 'w-[3.75em] h-[3.75em]'}`}/>
                        {!isCollapsed && (<div className="animate-fade-in overflow-hidden whitespace-nowrap flex flex-col justify-center"><span className="font-extrabold text-[1.25em] text-black leading-tight font-cafe24-deco">Open</span><span className={`font-bold text-[0.68em] leading-tight font-mustache ${textClass}`}>KoreanLearningLab</span></div>)}
                        <button onClick={toggleSidebar} className="absolute -right-[0.75em] top-1/2 -translate-y-1/2 bg-white border border-gray-200 rounded-full p-[0.25em] shadow-sm text-slate-500 hover:text-slate-700 hover:bg-gray-50 transition-colors z-10">{isCollapsed ? <ChevronRight className="w-[0.75em] h-[0.75em]" /> : <ChevronLeft className="w-[0.75em] h-[0.75em]" />}</button>
                    </div>
                    <nav className={`flex-1 space-y-[0.75em] mt-[1em] ${isCollapsed ? 'px-[0.75em]' : 'px-[0.75em]'}`}>
                        {menus.map((menu) => {
                            const IconComp = menu.icon; const isActive = activeTab === menu.id; const activeFontClass = isActive ? "font-cafe24-surround" : "font-cafe24";
                            return (
                                <button key={menu.id} onClick={() => { setActiveTab(menu.id); if (menu.id === 'learn' && !isCollapsed) toggleSidebar(); else if (menu.id !== 'learn' && isCollapsed) toggleSidebar(); }} onDoubleClick={toggleSidebar} className={`w-full flex items-center transition-all duration-200 group relative ${isCollapsed ? 'justify-center h-[3.5em] rounded-2xl' : 'gap-[0.75em] px-[0.75em] py-[1em] rounded-2xl'} ${isActive ? `bg-${themeColor}-50 text-${themeColor}-600` : 'text-slate-700 hover:bg-gray-50 hover:text-slate-900'}`}>
                                    {isActive && <div className={`absolute left-0 top-1/2 -translate-y-1/2 bg-${themeColor}-500 rounded-r-lg ${isCollapsed ? 'w-[0.375em] h-[2em]' : 'w-[0.25em] h-[1.5em]'}`}></div>}
                                    <IconComp className={`shrink-0 transition-all duration-200 ${isCollapsed ? 'w-[2em] h-[2em]' : 'w-[1.75em] h-[1.75em]'} ${isActive ? `text-${themeColor}-600` : 'text-slate-400 group-hover:text-slate-900'}`} filled={isActive} />
                                    {!isCollapsed && (<div className="flex flex-col items-start animate-fade-in overflow-hidden whitespace-nowrap"><span className={`text-[0.875em] leading-tight transition-all ${activeFontClass} ${isActive ? `font-extrabold text-${themeColor}-600` : 'font-medium text-slate-700 group-hover:font-semibold group-hover:text-slate-900'}`}>{menu.label}</span><span className="text-[0.625em] font-normal text-slate-400 mt-[0.125em] leading-tight">{menu.subLabel}</span></div>)}
                                    {isCollapsed && (<div className="absolute left-full ml-[0.75em] px-[0.75em] py-[0.375em] bg-slate-900 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-xl flex flex-col items-start"><span className="text-[0.75em] font-bold">{menu.label}</span><span className="text-[0.625em] opacity-80">{menu.subLabel}</span><div className="absolute top-1/2 -left-[0.25em] -translate-y-1/2 w-[0.5em] h-[0.5em] bg-slate-900 rotate-45"></div></div>)}
                                </button>
                            );
                        })}
                    </nav>
                    <div className="p-[0.5em] border-t border-gray-100">
                        <div className={`flex items-center gap-[0.75em] p-[0.5em] rounded-xl transition-colors hover:bg-gray-50 cursor-pointer ${isCollapsed ? 'justify-center' : ''}`}>
                            <div className={`w-[2.75em] h-[2.75em] rounded-xl flex items-center justify-center shrink-0 transition-colors duration-300 ${bgClass} border ${currentStyle.split(' ')[2]}`}><span className={`text-[1em] font-extrabold font-school-smile ${currentStyle.replace('bg-', 'text-').replace('50', '600')}`}>{userLevel}</span></div>
                            {!isCollapsed && (<div className="animate-fade-in overflow-hidden whitespace-nowrap flex-1"><p className="text-[0.875em] font-bold text-slate-900 mb-[0.0625em] font-basic">í•™ìŠµì (Learner)</p><div className="mt-[0.0625em]"><span className={`block w-fit px-[0.125em] py-[0.125em] rounded text-[0.625em] font-semibold border uppercase tracking-wide shadow-sm text-left cursor-help font-basic ${currentStyle}`} onMouseEnter={handleLevelTextEnter} onMouseLeave={handleLevelTextLeave}>Level: {LEVEL_DEFINITIONS[userLevel].title}</span></div></div>)}
                        </div>
                    </div>
                    {tooltip.show && tooltip.info && createPortal(<div className="fixed z-[9999] pointer-events-none animate-fade-in" style={{ left: tooltip.x, top: tooltip.y }}><div className="relative bg-slate-900/95 backdrop-blur text-white text-[0.75em] rounded-xl p-[1em] shadow-2xl transform -translate-y-full -translate-x-[1.5em] -mt-[0.75em] w-[16em] border border-slate-700/50"><p className={`font-bold mb-[0.375em] text-[0.875em] text-${themeColor}-300`}>{userLevel} â€“ {tooltip.info.title}</p><p className="opacity-90 leading-relaxed font-medium text-slate-200">{tooltip.info.desc}</p><div className="absolute -bottom-[0.375em] left-[1em] w-[0.75em] h-[0.75em] bg-slate-900/95 border-r border-b border-slate-700/50 rotate-45"></div></div></div>, document.body)}
                </aside>
            );
        };

        const LevelBadge = ({ levelCode }) => {
            const [isHovered, setIsHovered] = useState(false);
            const info = LEVEL_DEFINITIONS[levelCode] || LEVEL_DEFINITIONS["A2+"];
            const getLevelStyle = (code) => { if (LEVEL_STYLES[code]) return LEVEL_STYLES[code]; const base = code.substring(0, 2); return LEVEL_STYLES[base] || "bg-gray-50 text-slate-600 border-gray-100"; };
            const badgeStyle = getLevelStyle(levelCode);
            return (
                <div className="relative inline-flex items-center cursor-help z-50" onMouseEnter={() => setIsHovered(true)} onMouseLeave={() => setIsHovered(false)}><span className={`px-[0.5em] py-[0.125em] rounded text-[0.625em] font-bold border uppercase tracking-wide shadow-sm font-sunflower ${badgeStyle}`}>Level: {info.title}</span>{isHovered && (<div className="absolute top-full left-0 mt-[0.5em] w-[16em] bg-slate-900/95 backdrop-blur text-white text-[0.75em] rounded-xl p-[1em] shadow-xl z-[100] animate-fade-in text-left"><p className={`font-bold mb-[0.375em] text-[0.875em] ${badgeStyle.split(' ')[1]}`}>{levelCode} â€“ {info.title}</p><p className="opacity-90 leading-relaxed font-medium">{info.desc}</p><div className="absolute -top-[0.25em] left-[1em] w-[0.5em] h-[0.5em] bg-slate-900/95 rotate-45"></div></div>)}</div>
            );
        };

        const callGeminiWithBackoff = async (payload) => {
            const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`; const delays = [1000, 2000, 4000, 8000, 16000];
            for (let i = 0; i <= delays.length; i++) { try { const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }); if (!response.ok) throw new Error(`API error: ${response.statusText}`); return await response.json(); } catch (error) { if (i === delays.length) throw error; await new Promise(resolve => setTimeout(resolve, delays[i])); } }
        };

        const FeedbackSection = ({ value, onChange, placeholder, question, keyPhrases, themeColor }) => {
            const [feedback, setFeedback] = useState(null); const [isLoading, setIsLoading] = useState(false); const [error, setError] = useState(null);
            const checkSentence = async () => {
                if (!value || value.trim() === '') { setError("ë¬¸ì¥ì„ ì…ë ¥í•´ì•¼ í”¼ë“œë°±ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”."); setFeedback(null); return; }
                setIsLoading(true); setError(null); setFeedback(null);
                const systemPrompt = `You are an advanced Korean language tutor AI for A2 level learners...`; 
                const payload = { contents: [{ role: "user", parts: [{ text: systemPrompt }, { text: `Question: "${question}"\nUser's Answer: "${value}"` }] }], generationConfig: { responseMimeType: "application/json", responseSchema: { type: "OBJECT", properties: { "is_relevant": { "type": "BOOLEAN" }, "relevance_feedback_eng": { "type": "STRING", "nullable": true }, "is_correct": { "type": "BOOLEAN", "nullable": true }, "feedback_message_eng": { "type": "STRING", "nullable": true }, "corrected_sentence": { "type": "STRING", "nullable": true }, "explanation_eng": { "type": "STRING", "nullable": true } } } } };
                try { const result = await callGeminiWithBackoff(payload); if (result.candidates?.[0]?.content?.parts?.[0]?.text) setFeedback(JSON.parse(result.candidates[0].content.parts[0].text)); else setError("AIì˜ ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”."); } catch (err) { setError("ë¬¸ì¥ ê²€ì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”."); } finally { setIsLoading(false); }
            };
            return (
                <div>
                    {keyPhrases}
                    <div>
                        <h4 className="font-bold text-slate-900 mb-[0.75em] text-[1em]">í•µì‹¬ í‘œí˜„ì„ ì‚¬ìš©í•´ì„œ ì§ˆë¬¸ì— ëŒ€ë‹µí•´ ë³´ì„¸ìš”.</h4>
                        <textarea value={value} onChange={onChange} placeholder={placeholder} className={`w-full p-[1em] rounded-xl border border-gray-200 focus:border-${themeColor}-500 focus:ring-1 focus:ring-${themeColor}-500 outline-none min-h-[7.5em] resize-none text-[1em] text-slate-800 placeholder-gray-400 mb-[0.75em]`}></textarea>
                        <button onClick={checkSentence} disabled={!value.trim() || isLoading} className={`flex items-center gap-[0.5em] px-[1.25em] py-[0.375em] text-[0.75em] leading-tight rounded-xl font-bold transition-all shadow-sm ${!value.trim() || isLoading ? 'bg-gray-100 text-slate-400 cursor-not-allowed' : 'bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md'}`}>{isLoading ? <span>ë¶„ì„ ì¤‘...</span> : <> <SparklesIcon className="w-[1.25em] h-[1.25em]" /> <span>AI Feedback (í”¼ë“œë°± ë°›ê¸°)</span> </>}</button>
                        {error && <div className="mt-[1em] p-[1em] bg-red-50 text-red-600 rounded-xl border border-red-200 text-[0.875em] font-medium animate-fade-in">{error}</div>}
                        {feedback && (
                            <div className={`mt-[1.5em] rounded-2xl p-[1.5em] border animate-fade-in ${feedback.is_correct ? `bg-${themeColor}-50 border-${themeColor}-200` : 'bg-yellow-50 border-yellow-200'}`}>
                                <div className="flex items-center gap-[0.5em] mb-[1em]"><span className="text-[1.5em]">ğŸ¤–</span><h4 className="font-extrabold text-slate-900 text-[1.125em]">AI Tutor Feedback</h4></div>
                                <div className="mb-[1em]"><span className={`font-black text-[0.875em] px-[0.75em] py-[0.25em] rounded-full bg-white border shadow-sm ${feedback.is_correct ? `text-${themeColor}-600 border-${themeColor}-200` : 'text-yellow-600 border-yellow-200'}`}>{feedback.is_correct ? 'ğŸ‰ Great Job!' : 'âš ï¸ Needs Improvement'}</span></div>
                                <div className="space-y-[1em]">{feedback.feedback_message_eng && <div className="flex flex-col sm:flex-row gap-[0.25em] sm:gap-[1em]"><span className="font-bold text-slate-500 text-[0.875em] sm:w-[6em] shrink-0">Feedback</span><p className="text-slate-800 text-[0.875em] font-medium leading-relaxed">{feedback.feedback_message_eng}</p></div>}{feedback.explanation_eng && <div className="flex flex-col sm:flex-row gap-[0.25em] sm:gap-[1em]"><span className="font-bold text-slate-500 text-[0.875em] sm:w-[6em] shrink-0">Explanation</span><p className="text-slate-800 text-[0.875em] font-medium leading-relaxed">{feedback.explanation_eng}</p></div>}{feedback.corrected_sentence && <div className="flex flex-col sm:flex-row gap-[0.25em] sm:gap-[1em]"><span className="font-bold text-slate-500 text-[0.875em] sm:w-[6em] shrink-0">Correction</span><p className="text-slate-900 text-[1.125em] font-black leading-relaxed">{feedback.corrected_sentence}</p></div>}</div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const VocabCard = ({ word, themeColor }) => {
            const [isOpen, setIsOpen] = useState(false);
            return (
                <div className="bg-white p-[1.5em] rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition-all h-full flex flex-col">
                    <div className="flex justify-between mb-[1em]"><h3 className="text-[1.5em] font-extrabold text-slate-900">{word.term}</h3></div>
                    <div className={`pl-[1em] border-l-4 border-${themeColor}-500 mb-[1.5em]`}><p className="text-[1.3125em] text-slate-600 font-medium font-diary">{word.mainDef}</p></div>
                    <div className="flex-1 flex flex-col">
                        <button onClick={() => setIsOpen(!isOpen)} className="w-full flex items-center justify-between p-[1em] bg-gray-50 hover:bg-gray-100 rounded-xl transition-all group border border-transparent hover:border-gray-200"><div className="flex items-center gap-[0.5em]"><span className={`w-[0.375em] h-[0.375em] rounded-full transition-colors duration-300 ${isOpen ? `bg-${themeColor}-500` : 'bg-gray-400'}`}></span><span className={`text-[0.75em] font-bold uppercase tracking-wider transition-colors duration-300 ${isOpen ? `text-${themeColor}-700` : 'text-slate-500'}`}>Examples (ì˜ˆë¬¸)</span></div><ChevronRight className={`w-[1em] h-[1em] text-slate-400 transition-transform duration-300 ${isOpen ? 'rotate-90' : ''}`} /></button>
                        <div className={`overflow-hidden transition-all duration-300 ease-in-out ${isOpen ? 'max-h-[24em] opacity-100 mt-[0.5em]' : 'max-h-0 opacity-0'}`}><div className="bg-gray-50 rounded-xl p-[1em] space-y-[0.75em] border border-gray-100">{word.examples.map((ex, i) => (<div key={i}><p className="font-bold text-slate-800 text-[1.1875em] leading-relaxed font-marker">{ex.kor}</p><p className="text-slate-500 text-[1.0625em] mt-[0.125em] font-gowoonbam">{ex.eng}</p></div>))}</div></div>
                        {word.subDefs && word.subDefs.length > 0 && (<div className={`bg-${themeColor}-50 rounded-xl p-[1.25em] space-y-[0.5em] border border-${themeColor}-100 mt-[1em]`}><h4 className={`font-bold text-${themeColor}-800 text-[0.75em] mb-[0.5em] flex items-center gap-[0.5em] uppercase tracking-wider`}><span className={`w-[0.375em] h-[0.375em] rounded-full bg-${themeColor}-400`}></span>Related & Grammar</h4>{word.subDefs.map((sub, i) => (<div key={i} className="flex flex-col"><span className={`font-bold text-${themeColor}-900 text-[1.25em] font-school-free`}>{sub.subTerm}</span><span className={`text-[1.1875em] text-${themeColor}-600 font-dictation`}>{sub.subDef}</span></div>))}</div>)}
                    </div>
                </div>
            );
        };

        const HomeView = ({ setActiveTab, progress, userLevel, themeColor }) => {
            const completedCount = Object.values(progress).filter(val => val === true || (typeof val === 'number' && val > 0)).length;
            const percentage = Math.round((completedCount / 4) * 100);
            const quizScoreDisplay = typeof progress.quiz === 'number' ? `${progress.quiz}%` : (progress.quiz ? '100%' : '0%');
            const quizColorClass = (progress.quiz === 100 || progress.quiz === true) ? `text-${themeColor}-600` : 'text-slate-900';
            const quizIconBg = (progress.quiz === 100 || progress.quiz === true) ? `bg-${themeColor}-100 text-${themeColor}-600` : `bg-${themeColor}-50 text-${themeColor}-600`;

            return (
                <div style={{ fontSize: '1.25rem' }} className="space-y-[2.5em] animate-fade-in max-w-7xl mx-auto">
                    <div className="space-y-[0.75em]">
                        <div className="flex items-center gap-[0.5em]"><span className={`px-[0.5em] py-[0.25em] bg-${themeColor}-100 text-${themeColor}-700 text-[0.75em] font-extrabold rounded-md tracking-wider font-juache`}>íŒŸìºìŠ¤íŠ¸ (Podcast)</span><span className={`text-[0.75em] font-bold text-${themeColor}-600 tracking-wide uppercase font-school-smile`}>ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”! (Let's talk about this topic)</span></div>
                        <h1 className="text-[3em] font-black text-slate-900 tracking-tight font-cafe24-surround">ì—¬ë¦„ ì—ì–´ì»¨ ê³ ì¥ VS ê²¨ìš¸ ë³´ì¼ëŸ¬ ê³ ì¥</h1>
                        <p className="text-slate-500 text-[1.125em] font-cafe24-surround">Broken A/C in Summer vs. Broken Boiler in Winter</p>
                    </div>
                    <div className="bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden flex flex-col md:flex-row h-auto md:h-[20em]">
                        <div className="md:w-5/12 relative group bg-black cursor-pointer overflow-hidden" onClick={() => setActiveTab('learn')}>
                            <img src="https://img.youtube.com/vi/_5dwoII2L_M/maxresdefault.jpg" alt="Thumbnail" className="w-full h-full object-cover opacity-80 group-hover:opacity-60 transition-opacity duration-300" />
                            <div className="absolute top-[1.5em] left-[1.5em]"><span className="bg-[#ea3323] text-white text-[0.625em] font-bold px-[0.5em] py-[0.25em] rounded border border-[#ea3323] shadow-sm tracking-wider">ON AIR</span></div>
                            <div className="absolute inset-0 flex items-center justify-center"><div className="w-[3.5em] h-[3.5em] bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300"><PlayIconLine className={`w-[1.5em] h-[1.5em] text-${themeColor}-600 fill-current ml-[0.25em]`} /></div></div>
                        </div>
                        <div className="md:w-7/12 p-[2em] md:p-[2.5em] flex flex-col justify-center">
                            <div className="flex items-center gap-[0.5em] mb-[1em]"><span className="px-[0.5em] py-[0.25em] bg-gray-100 text-slate-600 text-[0.625em] font-bold rounded uppercase tracking-wide">Listening</span><LevelBadge levelCode={userLevel} /></div>
                            <div className="mb-[0.75em]"><h2 className="text-[1.5em] font-black text-slate-900 font-cafe24-surround">ë™ì˜ìƒ ìë£Œ</h2><span className="text-[0.875em] font-bold text-slate-400 font-cafe24-surround">Video Resources</span></div>
                            <div className="text-slate-600 text-[0.875em] leading-relaxed mb-[2em] pr-[1em]"><p>íŒŸìºìŠ¤íŠ¸ë¥¼ ë“£ê³  ë” ë”ì°í•œ ìƒí™©ì„ ê³¨ë¼ë³´ì„¸ìš”.</p><p className="mt-[0.25em] text-slate-400 text-[0.75em]">Listen to the podcast and choose the more terrible situation.</p></div>
                            <div className="flex items-center gap-[0.75em]"><button onClick={() => setActiveTab('learn')} className="px-[1.5em] py-[0.75em] bg-[#111827] text-white rounded-xl hover:bg-black transition-colors shadow-md flex flex-col items-center leading-tight"><span className="text-[0.875em] font-bold">ë™ì˜ìƒ ë³´ëŸ¬ ê°€ê¸°</span><span className="text-[0.625em] opacity-70 font-medium">Watch Video</span></button></div>
                        </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-[1.5em]">
                        <div className="bg-white p-[1.5em] rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between min-h-[10em] h-full hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start"><div><div className="flex flex-col"><span className="text-[0.75em] font-bold text-slate-500 font-cafe24-surround">í•µì‹¬ ì–´íœ˜</span><span className="text-[0.625em] text-slate-400 font-medium font-cafe24-surround">Key Vocabulary</span></div><p className="text-[2.25em] font-black text-slate-900 mt-[0.25em] font-jua">{VOCAB_DATA.length}ê°œ</p></div><div className={`w-[2.5em] h-[2.5em] bg-${themeColor}-50 text-${themeColor}-600 rounded-xl flex items-center justify-center`}><VocabIcon className="w-[1.25em] h-[1.25em]" /></div></div>
                            <button onClick={() => setActiveTab('vocab')} className="group flex items-center gap-[0.25em] transition-colors"><div className="flex flex-col items-start"><span className={`text-[0.75em] font-bold text-slate-400 group-hover:text-${themeColor}-600`}>í•µì‹¬ ì–´íœ˜ í™•ì¸</span><span className={`text-[0.625em] text-slate-300 group-hover:text-${themeColor}-400 font-medium`}>Check Vocabulary</span></div><span className={`text-[1.125em] leading-none text-slate-400 group-hover:text-${themeColor}-600 ml-[0.25em]`}>â†’</span></button>
                        </div>
                        <div className="bg-white p-[1.5em] rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between min-h-[10em] h-full hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start"><div><div className="flex flex-col"><span className="text-[0.75em] font-bold text-slate-500 font-cafe24-surround">ë‚´ìš© í™•ì¸ í€´ì¦ˆ</span><span className="text-[0.625em] text-slate-400 font-medium font-cafe24-surround">Comprehension Quiz</span></div><p className={`text-[2.25em] font-black mt-[0.25em] transition-all duration-500 font-jua ${quizColorClass}`}>{quizScoreDisplay}</p></div><div className={`w-[2.5em] h-[2.5em] rounded-xl flex items-center justify-center transition-colors ${quizIconBg}`}><QuizIcon className="w-[1.25em] h-[1.25em]" /></div></div>
                            <button onClick={() => setActiveTab('quiz')} className="group flex items-center gap-[0.25em] transition-colors"><div className="flex flex-col items-start"><span className={`text-[0.75em] font-bold text-slate-400 group-hover:text-${themeColor}-600`}>í€´ì¦ˆ ì‹œì‘í•˜ê¸°</span><span className={`text-[0.625em] text-slate-300 group-hover:text-${themeColor}-400 font-medium`}>Start Quiz</span></div><span className={`text-[1.125em] leading-none text-slate-400 group-hover:text-${themeColor}-600 ml-[0.25em]`}>â†’</span></button>
                        </div>
                        <div className="bg-white p-[1.5em] rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between min-h-[10em] h-full hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start"><div><div className="flex flex-col"><span className="text-[0.75em] font-bold text-slate-500 font-cafe24-surround">ìƒê°í•´ ë³´ê¸°</span><span className="text-[0.625em] text-slate-400 font-medium font-cafe24-surround">Food For Thought</span></div><div className="flex flex-col mt-[0.75em]"><a href="https://gemini.google.com/share/16a7c53d38d3" target="_blank" rel="noopener noreferrer" className={`text-[1.0625em] font-black text-${themeColor}-600 hover:text-${themeColor}-800 hover:underline transition-colors flex items-center gap-[0.25em] leading-tight`}>Gemini AI Feedback<ExternalLinkIcon className="w-[1em] h-[1em]" /></a></div></div><div className={`w-[2.5em] h-[2.5em] bg-${themeColor}-50 text-${themeColor}-600 rounded-xl flex items-center justify-center`}><DiscussIcon className="w-[1.25em] h-[1.25em]" /></div></div>
                            <button onClick={() => setActiveTab('discuss')} className="group flex items-center gap-[0.25em] transition-colors"><div className="flex flex-col items-start"><span className="text-[0.75em] font-bold text-slate-400 group-hover:text-blue-600">ë‹¤ìŒ ì§ˆë¬¸ë“¤ì„ ìƒê°í•´ ë³´ì„¸ìš”.</span><span className="text-[0.625em] text-slate-300 group-hover:text-blue-400 font-medium">Have a think about the following questions.</span></div><span className="text-[1.125em] leading-none text-slate-400 group-hover:text-blue-600 ml-[0.25em]">â†’</span></button>
                        </div>
                    </div>
                </div>
            );
        };

        const VocabView = ({ updateProgress, themeColor }) => {
            useEffect(() => { updateProgress('vocab'); }, []);
            return (
            <div style={{ fontSize: '1.4rem' }} className="max-w-7xl animate-fade-in mx-auto">
                <div className="flex items-center gap-[1em] mb-[2em]"><div className={`w-[4em] h-[4em] bg-${themeColor}-100 rounded-2xl flex items-center justify-center shrink-0`}><VocabIcon className={`w-[2.5em] h-[2.5em] text-${themeColor}-600`} /></div><div className="flex flex-col"><h2 className="text-[1.875em] font-black text-slate-900 font-cafe24-surround">í•µì‹¬ ì–´íœ˜</h2><span className="text-[1em] text-slate-500 font-medium font-cafe24-surround">Key Vocabulary</span></div></div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-[1.5em]">{VOCAB_DATA.map((word, idx) => (<VocabCard key={idx} word={word} themeColor={themeColor} />))}</div>
            </div>
            );
        };

        const QuizView = ({ updateProgress, themeColor }) => {
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [selectedOption, setSelectedOption] = useState(null);
            const [firstAttempts, setFirstAttempts] = useState({}); 
            const [isFinished, setIsFinished] = useState(false);
            const currentQuestion = QUIZ_LIST[currentQuestionIndex];
            const shuffledOptions = useMemo(() => { const options = [...currentQuestion.bank]; return options.sort(() => Math.random() - 0.5); }, [currentQuestion]);
            const isCorrect = selectedOption === currentQuestion.answer;
            const handleOptionClick = (option) => { if (firstAttempts[currentQuestionIndex] === undefined) { setFirstAttempts(prev => ({ ...prev, [currentQuestionIndex]: option === currentQuestion.answer })); } setSelectedOption(option); };
            const handleNext = () => { setSelectedOption(null); if (currentQuestionIndex < QUIZ_LIST.length - 1) { setCurrentQuestionIndex(prev => prev + 1); } else { finishQuiz(); } };
            const handlePrev = () => { if (currentQuestionIndex > 0) { setSelectedOption(null); setCurrentQuestionIndex(prev => prev - 1); } };
            const finishQuiz = () => { setIsFinished(true); const correctCount = Object.values(firstAttempts).filter(res => res === true).length; const finalScore = Math.round((correctCount / QUIZ_LIST.length) * 100); updateProgress('quiz', finalScore); };
            const handleRetry = () => { setCurrentQuestionIndex(0); setSelectedOption(null); setFirstAttempts({}); setIsFinished(false); updateProgress('quiz', 0); };

            if (isFinished) {
                const correctCount = Object.values(firstAttempts).filter(res => res === true).length; 
                return (
                    <div style={{ fontSize: '1.55rem' }} className="max-w-7xl animate-fade-in mx-auto text-center py-[2.5em]">
                        <div className="bg-white rounded-3xl border border-gray-200 shadow-sm p-[2.5em]">
                            <div className={`w-[5em] h-[5em] bg-${themeColor}-100 text-${themeColor}-600 rounded-full flex items-center justify-center mx-auto mb-[1.5em]`}><QuizIcon className="w-[2.5em] h-[2.5em]" /></div>
                            <h2 className="text-[1.875em] font-black text-slate-900 mb-[0.5em] font-cafe24-surround">í€´ì¦ˆ ì™„ë£Œ!</h2>
                            <p className="text-slate-500 mb-[2em]">ì´ {QUIZ_LIST.length}ë¬¸ì œ ì¤‘ {correctCount}ë¬¸ì œë¥¼ í•œ ë²ˆì— ë§í˜”ìŠµë‹ˆë‹¤.</p>
                            <div className={`text-[3em] font-black text-${themeColor}-600 mb-[2em] font-school-smile`}>{Math.round((correctCount / QUIZ_LIST.length) * 100)}%</div>
                            <button onClick={handleRetry} className={`px-[2em] py-[0.75em] rounded-xl bg-${themeColor}-600 text-white font-bold hover:bg-${themeColor}-700 transition-colors`}>ë‹¤ì‹œ í’€ê¸° (Try Again)</button>
                        </div>
                    </div>
                );
            }

            return (
                <div style={{ fontSize: '1.55rem' }} className="max-w-7xl animate-fade-in mx-auto">
                    <div className="flex items-center gap-[1em] mb-[1.5em]"><div className={`w-[4em] h-[4em] bg-${themeColor}-100 rounded-2xl flex items-center justify-center shrink-0`}><QuizIcon className="w-[2.5em] h-[2.5em] text-current" /></div><div className="flex flex-col"><h2 className="text-[1.875em] font-black text-slate-900 font-cafe24-surround">ë‚´ìš© í™•ì¸ í€´ì¦ˆ</h2><span className="text-[1em] text-slate-500 font-medium font-cafe24-surround">Comprehension Quiz ({currentQuestionIndex + 1}/{QUIZ_LIST.length})</span></div></div>
                    <div className="mb-[1.5em] p-[1em] bg-gray-50 rounded-xl border border-gray-200"><p className="font-bold text-slate-800">ë‹¤ìŒ ë¹ˆì¹¸ì— ì•Œë§ì€ ë§ì„ ê³ ë¥´ì„¸ìš”.</p><p className="text-slate-500 text-[0.875em]">Choose the correct word for the blank.</p></div>
                    <div className="bg-white rounded-2xl border border-gray-200 shadow-sm p-[0.5em]">
                        <div className="flex items-start gap-[0.75em] p-[1em]"><span className={`bg-${themeColor}-100 text-${themeColor}-700 font-black rounded-lg px-[0.5em] py-[0.25em] text-[0.875em] shrink-0`}>Q{currentQuestion.id}</span><div className="flex flex-col"><h3 className="font-bold text-slate-900 text-[1.125em] leading-snug">{currentQuestion.eng}</h3></div></div>
                        <div className="bg-gray-50 rounded-xl p-[1em] mb-[1em] mx-[0.25em]">
                            <div className="leading-relaxed text-[1.25em] font-bold text-slate-900">
                                {currentQuestion.parts[0]}
                                <div className={`inline-flex align-middle mx-[0.5em] px-[1em] py-[0.25em] rounded-md font-bold text-[1.25em] transition-all duration-300 min-w-[5em] text-center border-b-2 ${isCorrect ? `bg-${themeColor}-50 text-${themeColor}-700 border-${themeColor}-500` : (selectedOption ? 'bg-red-50 text-red-700 border-red-500' : 'bg-yellow-100 text-transparent border-yellow-400 select-none')}`}>
                                    {selectedOption ? selectedOption : `[ ${currentQuestion.blank} ]`}
                                </div>
                                {currentQuestion.parts[1]}
                                {selectedOption && (<span className={`ml-[0.5em] text-[1.125em] ${isCorrect ? `text-${themeColor}-600` : 'text-red-600'}`}>{isCorrect ? 'âœ“' : 'âœ—'}</span>)}
                            </div>
                        </div>
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-[0.75em] mb-[1em] px-[0.5em]">
                            {shuffledOptions.map((option, idx) => { const isSelected = selectedOption === option; let btnClass = "bg-white border-gray-200 text-slate-700 hover:bg-gray-50 hover:border-gray-300"; if (isSelected) { if (option === currentQuestion.answer) { btnClass = `bg-${themeColor}-500 border-${themeColor}-600 text-white shadow-md ring-2 ring-${themeColor}-200`; } else { btnClass = "bg-red-500 border-red-600 text-white shadow-md ring-2 ring-red-200"; } } return (<button key={idx} onClick={() => handleOptionClick(option)} className={`py-[0.75em] px-[1em] rounded-xl border font-bold text-[1em] transition-all duration-200 ${btnClass}`}>{option}</button>); })}
                        </div>
                        {selectedOption && (
                            <div className="p-[1em] rounded-xl border-l-4 mb-[1em] mx-[0.5em] animate-fade-in transition-all bg-[#f8fafc] border-gray-300">
                                <div className={`${isCorrect ? `bg-${themeColor}-50 border-${themeColor}-500` : 'bg-red-50 border-red-500'} p-[1em] rounded-lg border-l-4`}>
                                    <h4 className={`font-bold text-[0.875em] mb-[0.25em] ${isCorrect ? `text-${themeColor}-800` : 'text-red-800'}`}>{isCorrect ? 'Correct!' : 'Incorrect'}</h4>
                                    <p className={`text-[0.875em] italic ${isCorrect ? `text-${themeColor}-700` : 'text-red-700'}`}>{isCorrect ? currentQuestion.explanation : (currentQuestion.wrongAnswerExplanations[selectedOption] || "Try again!")}</p>
                                </div>
                            </div>
                        )}
                        <div className="flex justify-between items-center mt-[1em] border-t border-gray-100 pt-[1em] px-[0.5em] pb-[0.5em]">
                            <button onClick={handlePrev} disabled={currentQuestionIndex === 0} className={`px-[1.5em] py-[0.25em] rounded-xl font-bold flex items-center gap-[0.5em] transition-colors ${currentQuestionIndex === 0 ? 'text-slate-300 cursor-not-allowed' : 'text-slate-600 hover:bg-gray-100'}`}><span className="text-[1.125em]">â†</span><span className="text-[0.75em]">ì´ì „ ë¬¸ì œ (Prev)</span></button>
                            <span className="text-[0.75em] font-bold text-slate-600">{currentQuestionIndex + 1} / {QUIZ_LIST.length}</span>
                            <button onClick={handleNext} disabled={!isCorrect} className={`px-[1.5em] py-[0.25em] rounded-xl font-bold flex items-center gap-[0.5em] shadow-md transition-colors ${!isCorrect ? 'bg-gray-300 text-slate-500 cursor-not-allowed' : 'bg-gray-900 text-white hover:bg-black'}`}><span className="text-[0.75em]">{currentQuestionIndex < QUIZ_LIST.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œ (Next)' : 'ê²°ê³¼ ë³´ê¸° (Finish)'}</span><span className="text-[1.125em]">â†’</span></button>
                        </div>
                    </div>
                </div>
            );
        };

        const DiscussView = ({ updateProgress, themeColor }) => {
            const [answers, setAnswers] = useState({});
            const [showTranslations, setShowTranslations] = useState({});
            const handleTextChange = (id, value) => { setAnswers(prev => ({ ...prev, [id]: value })); };
            const toggleTranslation = (id) => { setShowTranslations(prev => ({ ...prev, [id]: !prev[id] })); };
            return (
                <div style={{ fontSize: '1.35rem' }} className="max-w-7xl mx-auto animate-fade-in">
                    <div className="flex items-center gap-[1em] mb-[2em]"><div className={`w-[4em] h-[4em] bg-${themeColor}-100 rounded-2xl flex items-center justify-center shrink-0`}><DiscussIcon className="w-[2.5em] h-[2.5em] text-current" /></div><div className="flex flex-col"><h2 className="text-[1.875em] font-black text-slate-900 font-cafe24-surround">ìƒê°í•´ ë³´ê¸°</h2><span className="text-[1em] text-slate-500 font-medium font-cafe24-surround">Food For Thought</span></div></div>
                    <div className={`mb-[2em] p-[1em] rounded-2xl bg-${themeColor}-50 border border-${themeColor}-100`}><div className="text-slate-800 text-[0.875em] font-medium leading-relaxed"><p>AI Feedbackì€ Gemini ì›¹í˜ì´ì§€ì—ì„œë§Œ ì‘ìš©í•˜ê¸° ë•Œë¬¸ì— Github ì›¹í˜ì´ì§€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš”.</p><p className="text-slate-500 text-[0.75em] mt-[0.25em] mb-[1em]">AI Feedback only works on the Gemini webpage, so it cannot be used on the GitHub webpage.</p><p className="flex flex-wrap items-center gap-[0.25em]">AI Feedback ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ì›í•  ê²½ìš°, ë‹¤ìŒ ë§í¬ë¥¼ í´ë¦­í•˜ì„¸ìš”: <a href="https://gemini.google.com/share/16a7c53d38d3" target="_blank" rel="noopener noreferrer" className={`font-bold text-${themeColor}-600 hover:underline inline-flex items-center gap-0.5`}>Gemini AI Feedback<ExternalLinkIcon className="w-[0.75em] h-[0.75em]" /></a></p><p className="text-slate-500 text-[0.75em] mt-[0.25em] flex flex-wrap items-center gap-[0.25em]">To use the AI feedback feature, please click the following link: <a href="https://gemini.google.com/share/16a7c53d38d3" target="_blank" rel="noopener noreferrer" className={`font-bold text-${themeColor}-600 hover:underline inline-flex items-center gap-0.5`}>Gemini AI Feedback<ExternalLinkIcon className="w-[0.75em] h-[0.75em]" /></a></p></div></div>
                    <div className="bg-white rounded-3xl border border-gray-200 shadow-sm p-[2em] md:p-[2.5em]">
                        {DISCUSS_DATA.map((item, index) => (
                            <div key={item.num} className={index < DISCUSS_DATA.length - 1 ? "mb-[3em] border-b border-gray-100 pb-[3em]" : "mb-[2em]"}>
                                <div className="mb-[2em]">
                                    <h3 className="text-[1.25em] font-bold text-slate-900 mb-[0.5em]" dangerouslySetInnerHTML={{__html: item.kor}}></h3>
                                    {showTranslations[item.num] && (<p className="text-slate-500 text-[0.875em] mb-[0.75em] animate-fade-in font-medium">{item.eng}</p>)}
                                    <button onClick={() => toggleTranslation(item.num)} className="inline-flex items-center gap-[0.25em] text-[0.5em] font-normal text-slate-400 hover:text-slate-600 font-cafe24 bg-transparent transition-colors"><TranslateIcon className="w-[0.75em] h-[0.75em]" /><span>{showTranslations[item.num] ? 'ë²ˆì—­ ìˆ¨ê¸°ê¸° (Hide)' : 'ë²ˆì—­ (Translation)'}</span></button>
                                </div>
                                <FeedbackSection themeColor={themeColor} question={item.kor.replace(/<[^>]*>?/gm, '')} value={answers[item.num] || ''} onChange={(e) => handleTextChange(item.num, e.target.value)} placeholder="ì—¬ê¸°ì— ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš” (Type your response here)" keyPhrases={
                                    <div className="mb-[2.5em] space-y-[1em]">
                                        <div className="flex items-center gap-[0.5em]"><span className="text-red-500 text-[1.125em]">ğŸ“</span><h4 className="font-bold text-slate-900 text-[1.125em]">í•µì‹¬ í‘œí˜„ (Essential phrases)</h4></div>
                                        <div className="space-y-[1.5em] pl-[0.25em]">{item.vocab.map((v, i) => (<div key={i} className={`pl-[1em] border-l-4 border-${themeColor}-500 bg-gray-50 p-2 rounded-r-lg`}><p className="text-slate-800 font-bold text-[1.125em] mb-[0.25em]">{v.term}</p><p className="text-slate-600 text-[0.9em] mb-[0.5em] italic">{v.meaning}</p><div className="text-[0.85em] text-slate-500 border-t border-gray-200 pt-[0.5em]"><p className="font-medium text-slate-700">Context:</p><p>{v.context}</p><p className="text-slate-400 text-[0.9em]">{v.context_eng}</p></div></div>))}</div>
                                    </div>
                                } />
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const LearnView = ({ updateProgress, themeColor, autoScroll, showVocab, playbackRate, layoutMode, onPlayerReady, onPlayerStateChange, onTimeUpdate }) => {
            const [player, setPlayer] = useState(null); const playerRef = useRef(null); const [currentTime, setCurrentTime] = useState(0); const [activeLine, setActiveLine] = useState(null); const [translations, setTranslations] = useState({}); const [popup, setPopup] = useState({ show: false, fixed: false, data: null, x: 0, y: 0 }); const [activeVocabTerm, setActiveVocabTerm] = useState(null); const [isLoading, setIsLoading] = useState(true); const sidebarVocabRefs = useRef({}); const scriptRefs = useRef({}); const intervalRef = useRef(null);

            useEffect(() => {
                const loadVideo = () => { if (window.YT && window.YT.Player) { new window.YT.Player('youtube-player', { videoId: '_5dwoII2L_M', width: '100%', height: '100%', playerVars: { 'autoplay': 0, 'controls': 1, 'rel': 0 }, events: { 'onReady': (event) => { playerRef.current = event.target; setPlayer(event.target); setIsLoading(false); if (onPlayerReady) onPlayerReady(event.target); }, 'onStateChange': (event) => { if (event.data === window.YT.PlayerState.PLAYING) { startInterval(); updateProgress('learn'); } else { stopInterval(); } if (onPlayerStateChange) onPlayerStateChange(event); } } }); } };
                if (!window.YT) { const tag = document.createElement('script'); tag.src = "https://www.youtube.com/iframe_api"; const firstScriptTag = document.getElementsByTagName('script')[0]; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); window.onYouTubeIframeAPIReady = loadVideo; } else { loadVideo(); }
                return () => stopInterval();
            }, []);

            useEffect(() => { if (player && player.setPlaybackRate) player.setPlaybackRate(playbackRate); }, [playbackRate, player]);

            const startInterval = () => { stopInterval(); const updateTime = () => { const p = playerRef.current; if (p && p.getCurrentTime) { const time = p.getCurrentTime(); setCurrentTime(time); if (onTimeUpdate) onTimeUpdate(time); const currentLine = SCRIPT_DATA.find(line => time >= line.time[0] && time < line.time[1]); if (currentLine) { setActiveLine(currentLine.id); } } intervalRef.current = requestAnimationFrame(updateTime); }; intervalRef.current = requestAnimationFrame(updateTime); };
            const stopInterval = () => { if (intervalRef.current) { cancelAnimationFrame(intervalRef.current); intervalRef.current = null; } };
            
            useEffect(() => { if (popup.show) return; if (activeLine && autoScroll && scriptRefs.current[activeLine]) { scriptRefs.current[activeLine].scrollIntoView({ behavior: 'smooth', block: 'center' }); } }, [activeLine, autoScroll, popup.show]);

            const handleLineClick = (time) => { if (player) { player.seekTo(time, true); player.playVideo(); } };
            const toggleTranslation = (id) => setTranslations(prev => ({...prev, [id]: !prev[id]}));
            const scrollToVocab = (term) => { const element = sidebarVocabRefs.current[term]; if (element) element.scrollIntoView({ behavior: 'smooth', block: 'center' }); };

            const handleVocabEnter = (e, wordData) => { if (popup.fixed) return; const rect = e.target.getBoundingClientRect(); setPopup({ show: true, fixed: false, data: wordData, x: rect.left + rect.width / 2, y: rect.bottom }); if (showVocab) { setActiveVocabTerm(wordData.term); scrollToVocab(wordData.term); } };
            const handleVocabLeave = () => { if (popup.fixed) return; setPopup(prev => ({ ...prev, show: false })); };
            const handleVocabClick = (e, wordData) => { e.stopPropagation(); if (popup.fixed && popup.data && popup.data.term === wordData.term) { setPopup(prev => ({ ...prev, show: false, fixed: false })); return; } const rect = e.target.getBoundingClientRect(); setPopup({ show: true, fixed: true, data: wordData, x: rect.left + rect.width / 2, y: rect.bottom }); if (showVocab) { setActiveVocabTerm(wordData.term); scrollToVocab(wordData.term); } };

            const renderTextWithVocab = (text) => {
                if (!VOCAB_DATA || !Array.isArray(VOCAB_DATA)) return text;
                const allTerms = VOCAB_DATA.flatMap(vocab => { const terms = [vocab.term]; if (vocab.variants) terms.push(...vocab.variants); return terms.map(term => ({ term, vocab })); }).sort((a, b) => b.term.length - a.term.length);
                const matches = []; allTerms.forEach(({ term, vocab }) => { let index = 0; while ((index = text.indexOf(term, index)) !== -1) { const end = index + term.length; const overlaps = matches.some(m => (index >= m.start && index < m.end) || (end > m.start && end <= m.end)); if (!overlaps) matches.push({ start: index, end, term, vocab }); index = end; } }); matches.sort((a, b) => a.start - b.start);
                const result = []; let lastIndex = 0; matches.forEach((match, idx) => { if (match.start > lastIndex) result.push(text.substring(lastIndex, match.start)); result.push({ isVocab: true, ...match.vocab, displayText: match.term, key: idx }); lastIndex = match.end; }); if (lastIndex < text.length) result.push(text.substring(lastIndex));
                return result.map((part, index) => { if (typeof part === 'string') return part; const isActive = (popup.show && popup.data && popup.data.term === part.term) || (showVocab && activeVocabTerm === part.term); return (<span key={part.key} className={`cursor-pointer border-b-2 transition-all duration-200 font-bold inline-block leading-tight ${isActive ? `text-${themeColor}-700 border-${themeColor}-500 bg-${themeColor}-100 rounded-sm px-0.5 mx-0.5` : `text-slate-900 border-dashed border-gray-400 hover:text-${themeColor}-600 hover:border-${themeColor}-400 hover:bg-${themeColor}-50`}`} onMouseEnter={(e) => handleVocabEnter(e, part)} onMouseLeave={handleVocabLeave} onClick={(e) => handleVocabClick(e, part)}>{part.displayText}</span>); });
            };

            const getSmartPosition = () => { if (!popup.show || !popup.data) return { left: 0, arrowLeft: 0 }; const POPUP_WIDTH = 288; const SCREEN_PADDING = 16; const screenW = window.innerWidth; let leftPos = popup.x - (POPUP_WIDTH / 2); if (leftPos < SCREEN_PADDING) leftPos = SCREEN_PADDING; else if (leftPos + POPUP_WIDTH > screenW - SCREEN_PADDING) leftPos = screenW - POPUP_WIDTH - SCREEN_PADDING; let arrowLeft = popup.x - leftPos; if (arrowLeft < 12) arrowLeft = 12; if (arrowLeft > POPUP_WIDTH - 12) arrowLeft = POPUP_WIDTH - 12; return { left: leftPos, arrowLeft }; };
            const { left: popupLeft, arrowLeft } = getSmartPosition();

            const getVideoClass = () => { if (layoutMode === 'script') return 'hidden'; if (layoutMode === 'video') { return `w-full h-full bg-black lg:h-full lg:aspect-auto ${showVocab ? 'xl:w-9/12 lg:w-full' : 'lg:w-full'}`; } let base = 'w-full sticky top-1 z-50 bg-black aspect-video lg:static lg:aspect-auto'; return `${base} flex-1 lg:h-full`; };
            const getScriptClass = () => { if (layoutMode === 'video') return 'hidden'; if (layoutMode === 'script') { return showVocab ? 'lg:flex-1 h-auto' : 'w-full max-w-7xl mx-auto h-auto'; } return `w-full lg:w-5/12 ${showVocab ? 'xl:w-4/12' : ''} lg:h-full`; };
            const getContainerClass = () => { if (layoutMode === 'script') return 'items-start min-h-full'; if (layoutMode === 'video') { return 'h-[calc(100vh-9rem)] lg:h-[calc(100vh-4rem)] lg:overflow-hidden flex-col lg:flex-row'; } return 'min-h-full lg:h-[calc(100vh-4rem)] lg:overflow-hidden flex-col lg:flex-row'; }
            const getInnerListStyle = () => { const baseStyle = "space-y-[1em] rounded-xl transition-all duration-300"; if (layoutMode === 'script') { return `${baseStyle} p-[1.5em] bg-slate-100 overflow-visible h-auto`; } else { return `${baseStyle} p-[1em] bg-gray-50 overflow-visible lg:overflow-y-auto flex-1`; } };

            return (
                <div className={`flex gap-[1em] animate-fade-in relative w-full mx-auto ${getContainerClass()}`}>
                    {popup.show && popup.data && createPortal(<div className="fixed z-[9999] bg-white rounded-xl shadow-xl border border-gray-200 p-[1em] w-[18em] animate-fade-in pointer-events-none" style={{ left: popupLeft, top: popup.y + 12 }}><div className="flex items-center justify-between mb-[0.5em]"><h3 className="text-[1.25em] font-black text-slate-900 font-ocarina">{popup.data.term}</h3></div><p className="text-[1.1875em] text-slate-700 font-medium mb-[0.75em] leading-snug font-diary">{popup.data.mainDef}</p>{popup.fixed && popup.data.subDefs && popup.data.subDefs.length > 0 && (<div className="space-y-[0.25em] mt-[0.5em]">{popup.data.subDefs.map((sub, idx) => (<div key={idx} className={`bg-${themeColor}-50 rounded-lg p-[0.5em] border border-${themeColor}-100`}><p className={`text-[1.125em] text-${themeColor}-900 font-bold font-school-free`}>{sub.subTerm}</p><p className={`text-[1.0625em] text-${themeColor}-700 font-dictation`}>{sub.subDef}</p></div>))}</div>)}<div className="absolute top-0 -translate-x-1/2 -translate-y-1/2 w-[0.75em] h-[0.75em] bg-white border-l border-t border-gray-200 rotate-45" style={{ left: arrowLeft }}></div></div>, document.body)}
                    <div className={`bg-black rounded-xl overflow-hidden shadow-lg transition-all duration-300 relative ${getVideoClass()}`}><div id="youtube-player" className="w-full h-full"></div>{isLoading && (<div className="absolute inset-0 bg-black/90 flex items-center justify-center z-10"><div className={`animate-spin rounded-full h-[3em] w-[3em] border-4 border-t-transparent border-${themeColor}-500 opacity-80`}></div></div>)}</div>
                    <div style={{ fontSize: '1.3rem' }} className={`flex flex-col rounded-xl border border-gray-200 shadow-sm transition-all duration-300 bg-gray-50 ${getScriptClass()}`}>
                        <div className={getInnerListStyle()}>
                            {SCRIPT_DATA.map(line => {
                                const isActive = activeLine === line.id; const isScriptMode = layoutMode === 'script';
                                if (isScriptMode) {
                                    const isLeft = line.speaker === 'ìš°ë””'; const bubbleBg = isActive ? 'bg-yellow-50' : 'bg-white'; const bubbleBorder = isActive ? 'border-yellow-100' : 'border-slate-200';
                                    return (
                                        <div key={line.id} ref={el => scriptRefs.current[line.id] = el} className={`flex flex-col w-full mb-[1.5em] ${isLeft ? 'items-start' : 'items-end'}`}>
                                            <div className={`text-[0.75em] font-bold text-slate-500 mb-[0.25em] px-[0.5em] ${isLeft ? 'text-left' : 'text-right'}`}>{line.speaker}</div>
                                            <div className={`relative p-[1.25em] rounded-xl border ${bubbleBg} ${bubbleBorder} ${isActive ? 'scale-[1.02] shadow-md z-10' : 'hover:shadow-md'} transition-all duration-300 max-w-[85%] sm:max-w-[70%] group`}>
                                                <div className={`absolute bottom-[1em] w-[0.75em] h-[0.75em] border ${bubbleBg} ${bubbleBorder} rotate-45 transform ${isLeft ? '-left-[0.375em] border-t-0 border-r-0' : '-right-[0.375em] border-b-0 border-l-0'}`}></div>
                                                <div className="relative z-10" onClick={() => handleLineClick(line.time[0])}><p className="text-[1.125em] sm:text-[1.25em] text-slate-800 leading-relaxed font-medium">{renderTextWithVocab(line.kor)}</p>{translations[line.id] && (<div className="mt-[0.75em] pt-[0.75em] border-t border-dashed border-gray-200/60 animate-fade-in"><p className="text-[1em] text-slate-500">{line.eng}</p></div>)}</div>
                                                <div className="flex justify-between items-center mt-[1em] pt-[0.25em]"><button onClick={(e) => { e.stopPropagation(); toggleTranslation(line.id); }} className="flex items-center gap-[0.25em] text-[0.6875em] font-bold text-slate-400 hover:text-slate-600 transition-colors p-[0.25em] rounded-lg hover:bg-gray-100/50"><TranslateIcon className="w-[0.875em] h-[0.875em]" /><span>{translations[line.id] ? 'ìˆ¨ê¸°ê¸°' : 'ë²ˆì—­'}</span></button><button onClick={(e) => { e.stopPropagation(); handleLineClick(line.time[0]); }} className={`transition-all duration-200 hover:scale-110 ${isActive ? 'text-yellow-700' : 'text-slate-400 hover:text-slate-600'}`} title="Play this line"><PlayCircleIcon className="w-[1.25em] h-[1.25em]" /></button></div>
                                            </div>
                                        </div>
                                    );
                                }
                                return (
                                    <div key={line.id} ref={el => scriptRefs.current[line.id] = el} className="flex flex-col">
                                        <div className="flex items-center gap-[0.5em] mb-[0.25em] ml-[0.25em]"><span className="text-[0.75em] font-bold text-slate-600">{line.speaker}</span></div>
                                        <div onClick={() => handleLineClick(line.time[0])} className={`p-[1.25em] rounded-2xl border transition-all duration-300 cursor-pointer relative group ${isActive ? 'bg-yellow-50 border-yellow-100 shadow-md scale-[1.01]' : 'bg-white border-gray-200 hover:border-gray-300'}`}>
                                            <p className="text-[1.375em] text-slate-800 leading-relaxed font-medium">{renderTextWithVocab(line.kor)}</p>
                                            {translations[line.id] && (<div className="mt-[0.75em] pt-[0.75em] border-t border-dashed border-gray-200 animate-fade-in"><p className="text-[1.125em] text-slate-500">{line.eng}</p></div>)}
                                            <div className="flex justify-between items-center mt-[1em] pt-[0.75em] border-t border-dashed border-gray-100"><button onClick={(e) => { e.stopPropagation(); toggleTranslation(line.id); }} className="flex items-center gap-[0.25em] text-[0.6875em] font-bold text-slate-400 hover:text-slate-600 transition-colors p-[0.25em] rounded-lg hover:bg-gray-100/50"><TranslateIcon className="w-[0.875em] h-[0.875em]" /><span>{translations[line.id] ? 'ìˆ¨ê¸°ê¸°' : 'ë²ˆì—­'}</span></button><button onClick={(e) => { e.stopPropagation(); handleLineClick(line.time[0]); }} className={`transition-all duration-200 hover:scale-110 ${isActive ? 'text-yellow-700' : 'text-slate-400 hover:text-slate-600'}`} title="Play this line"><PlayCircleIcon className="w-[1.25em] h-[1.25em]" /></button></div>
                                        </div>
                                    </div>
                                );
                            })}
                            <div className="h-[8em]"></div>
                        </div>
                    </div>
                    {showVocab && (
                        <div className={`hidden xl:flex w-3/12 flex flex-col bg-white rounded-xl border border-gray-200 shadow-sm animate-fade-in ${layoutMode === 'script' ? 'sticky top-[1em] h-[calc(100vh-6rem)]' : 'h-full'}`}>
                            <div className="p-[1em] border-b border-gray-100 flex items-center gap-[0.5em] bg-white rounded-t-xl"><VocabIcon className={`w-[1.25em] h-[1.25em] text-${themeColor}-600`} /><div className="flex flex-col leading-none"><h2 className="font-bold text-slate-900 text-[0.875em]">í•µì‹¬ ì–´íœ˜</h2><span className="text-[0.625em] text-slate-400 font-medium">Key Vocabulary</span></div></div>
                            <div className="flex-1 overflow-y-auto p-[1em] space-y-[1em] bg-gray-50">{VOCAB_DATA.map((word, idx) => (<div key={idx} ref={el => sidebarVocabRefs.current[word.term] = el} className={`p-[1em] rounded-xl border transition-all duration-500 ${activeVocabTerm === word.term ? `border-${themeColor}-500 bg-${themeColor}-50 ring-2 ring-${themeColor}-200 shadow-md scale-105` : 'bg-white border-gray-200 shadow-sm'}`}><div className="flex justify-between items-start mb-[0.5em]"><h3 className="text-[1.25em] font-extrabold text-slate-900 font-ocarina">{word.term}</h3></div><p className="text-[1.1875em] text-slate-600 mb-[0.75em] font-medium font-diary">{word.mainDef}</p>{word.subDefs && word.subDefs.length > 0 && (<div className={`space-y-[0.5em] bg-${themeColor}-50 p-[0.625em] rounded-lg border border-${themeColor}-100`}>{word.subDefs.map((sub, i) => (<div key={i}><p className={`text-[1.125em] text-${themeColor}-900 font-bold leading-snug font-school-free`}>{sub.subTerm}</p><p className={`text-[1.0625em] text-${themeColor}-700 font-dictation`}>{sub.subDef}</p></div>))}</div>)}</div>))}</div>
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('home'); const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false); const [userLevel, setUserLevel] = useState("A2+"); const [autoScroll, setAutoScroll] = useState(true); const [showVocab, setShowVocab] = useState(false); const [playbackRate, setPlaybackRate] = useState(1.0); const [isSpeedMenuOpen, setIsSpeedMenuOpen] = useState(false); const [layoutMode, setLayoutMode] = useState('split'); const [progress, setProgress] = useState({ learn: false, vocab: false, quiz: 0, discuss: false }); const [videoState, setVideoState] = useState({ player: null, currentTime: 0, duration: 0, isPlaying: false });
            const themeColor = useMemo(() => getLevelTheme(userLevel), [userLevel]);
            const themeHexColors = { 'lime': '#a3e635', 'green': '#4ade80', 'sky': '#38bdf8', 'blue': '#60a5fa', 'violet': '#a78bfa', 'fuchsia': '#e879f9', 'purple': '#c084fc' };
            const currentThemeHex = themeHexColors[themeColor] || '#4ade80';
            const updateProgress = (key, value = true) => setProgress(prev => { if (prev[key] === value) return prev; return { ...prev, [key]: value }; });
            const handlePlayerReady = (player) => setVideoState(prev => ({ ...prev, player, duration: player.getDuration() }));
            const handlePlayerStateChange = (event) => setVideoState(prev => ({ ...prev, isPlaying: event.data === window.YT.PlayerState.PLAYING }));
            const handleTimeUpdate = (time) => setVideoState(prev => ({ ...prev, currentTime: time }));
            const mainPaddingClass = useMemo(() => { switch(activeTab) { case 'home': return 'p-[1.25rem]'; case 'learn': return 'p-[0.125rem]'; case 'vocab': return 'p-[1rem]'; case 'quiz': return 'p-[0.25rem]'; case 'discuss': return 'p-[0.125rem]'; default: return 'p-[1.25rem]'; } }, [activeTab]);
            const getScrollClass = () => { if (activeTab === 'learn') { if (layoutMode === 'video') return 'lg:overflow-hidden'; if (layoutMode === 'split') return 'lg:overflow-hidden'; } return ''; };
            useEffect(() => { const handleResize = () => { if (window.innerWidth < 1024) setIsSidebarCollapsed(true); else setIsSidebarCollapsed(false); }; window.addEventListener('resize', handleResize); handleResize(); return () => window.removeEventListener('resize', handleResize); }, []);
            const toggleSidebar = () => setIsSidebarCollapsed(!isSidebarCollapsed);

            const renderLearnHeaderContent = () => {
                 const modes = [ { id: 'split', labelKorDesktop: 'ë™ì˜ìƒ & ìŠ¤í¬ë¦½íŠ¸', labelKorMobile: 'ë™ì˜ìƒ & ìŠ¤í¬ë¦½íŠ¸', labelEng: 'Video & Transcript' }, { id: 'video', labelKorDesktop: 'ë™ì˜ìƒë§Œ ë³´ê¸°', labelKorMobile: 'ë™ì˜ìƒ', labelEngDesktop: 'Watch Video', labelEngMobile: 'Video' }, { id: 'script', labelKorDesktop: 'ìŠ¤í¬ë¦½íŠ¸ë§Œ ë³´ê¸°', labelKorMobile: 'ìŠ¤í¬ë¦½íŠ¸', labelEngDesktop: 'Read Transcript', labelEngMobile: 'Transcript' } ];
                const { player, currentTime, duration, isPlaying } = videoState;
                const formatTime = (seconds) => { if (isNaN(seconds)) return "00:00"; const date = new Date(seconds * 1000); const mm = date.getUTCMinutes(); const ss = date.getUTCSeconds(); return `${mm.toString().padStart(2, '0')}:${ss.toString().padStart(2, '0')}`; };
                const handleSeek = (e) => { const time = parseFloat(e.target.value); if (player) player.seekTo(time, true); setVideoState(prev => ({ ...prev, currentTime: time })); };
                const togglePlay = () => { if (player) { if (isPlaying) player.pauseVideo(); else player.playVideo(); } };
                const rewind2 = () => { if (player) player.seekTo(Math.max(0, currentTime - 1.5), true); };
                const forward2 = () => { if (player) player.seekTo(Math.min(duration, currentTime + 1.5), true); };
                const layoutBtnTextSizeKor = "text-[0.75em] md:text-[0.8125em] lg:text-[0.875em]"; const layoutBtnTextSizeEng = "text-[0.5em] md:text-[0.5625em] lg:text-[0.625em]"; const layoutBtnPadding = "px-[0.5em] py-[0.25em] lg:px-[1em] lg:py-[0.5em]"; const controlBtnHeight = "h-[2em] md:h-[2em] lg:h-[2.25em]"; const controlTextSize = "text-[0.625em] md:text-[0.6875em] lg:text-[0.75em]"; const controlPadding = "px-[0.75em]";

                return (
                    <div className="flex items-center h-full px-[1em] lg:px-[1.5em] border-b border-gray-100 bg-white/90 backdrop-blur gap-[1em]">
                        <div className="flex items-center gap-[0.5em] shrink-0">{modes.map((mode, index) => { const isActive = layoutMode === mode.id; const korFontClass = isActive ? "font-cafe24-surround text-green-700" : "font-cafe24 text-slate-500"; const engFontClass = isActive ? "font-bold text-green-500" : "font-medium text-slate-400"; const containerClass = isActive ? `bg-${themeColor}-50 border border-${themeColor}-100 shadow-sm` : 'bg-transparent border border-transparent hover:bg-gray-50'; return ( <React.Fragment key={mode.id}><button onClick={() => setLayoutMode(mode.id)} className={`flex flex-col items-center justify-center rounded-xl transition-all duration-300 ${layoutBtnPadding} ${containerClass}`}><span className={`leading-tight ${layoutBtnTextSizeKor} ${korFontClass}`}><span className="hidden md:inline">{mode.labelKorDesktop}</span><span className="md:hidden">{mode.labelKorMobile}</span></span><span className={`leading-tight font-nanum-round mt-[0.125em] ${layoutBtnTextSizeEng} ${engFontClass}`}><span className="hidden md:inline">{mode.labelEngDesktop || mode.labelEng}</span><span className="md:hidden">{mode.labelEngMobile || mode.labelEng}</span></span></button>{index < modes.length - 1 && <div className="w-px h-[0.75em] bg-gray-300"></div>}</React.Fragment> ); })}</div>
                        <div className="flex items-center gap-[0.5em] flex-1 justify-end min-w-0">
                            <div className={`hidden sm:flex flex-1 items-center gap-[0.25em] bg-white border border-gray-200 rounded-xl p-[0.25em] shadow-sm min-w-0 transition-all ${controlBtnHeight} ${showVocab ? '' : 'max-w-[25em]'}`}>
                                <div className="hidden md:flex flex-col flex-1 px-[0.5em] justify-center w-full min-w-[3.75em] lg:min-w-[5em]"><input type="range" min="0" max={duration || 100} value={currentTime} onChange={handleSeek} className="w-full h-[0.25em] bg-gray-200 rounded-lg appearance-none cursor-pointer" style={{ '--thumb-color': currentThemeHex }} /><div className="text-[0.5em] font-mono text-center leading-none mt-[0.25em] text-slate-400 font-bold whitespace-nowrap">{formatTime(currentTime)} / {formatTime(duration)}</div></div>
                                <button onClick={rewind2} className="p-[0.25em] hover:bg-gray-100 rounded-lg text-slate-600 transition-colors shrink-0" title="-1.5s"><RewindIcon className="w-[1em] h-[1em]" /></button><button onClick={togglePlay} className={`w-[1.25em] h-[1.25em] lg:w-[1.5em] lg:h-[1.5em] flex items-center justify-center rounded-xl transition-all duration-200 hover:scale-110 bg-${themeColor}-400 text-white shadow-md shrink-0`} title={isPlaying ? "Pause" : "Play"}>{isPlaying ? <PauseIcon className="w-[1em] h-[1em] lg:w-[1.25em] lg:h-[1.25em] fill-current" /> : <PlayIconSolid className="w-[1em] h-[1em] lg:w-[1.25em] lg:h-[1.25em] fill-current" />}</button><button onClick={forward2} className="p-[0.25em] hover:bg-gray-100 rounded-lg text-slate-600 transition-colors shrink-0" title="+1.5s"><ForwardIcon className="w-[1em] h-[1em]" /></button>
                            </div>
                            <div className="w-px h-[0.75em] bg-gray-300 shrink-0 hidden sm:block"></div>
                            <div className="relative shrink-0 hidden sm:block"><button onClick={() => setIsSpeedMenuOpen(!isSpeedMenuOpen)} className={`flex items-center gap-[0.5em] ${controlPadding} ${controlBtnHeight} rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-all shadow-sm text-slate-600`}><SpeedSolidIcon className="w-[1em] h-[1em] text-slate-400" /><span className={`${controlTextSize} font-bold font-nanum-round min-w-[2em] text-center`}>{playbackRate.toFixed(2)}x</span></button>{isSpeedMenuOpen && (<><div className="fixed inset-0 z-40" onClick={() => setIsSpeedMenuOpen(false)}></div><div className="absolute top-full right-0 mt-[0.5em] bg-white border border-gray-100 rounded-xl shadow-xl p-[0.375em] z-50 w-[6em] flex flex-col gap-[0.125em] animate-fade-in">{[0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0].map(speed => (<button key={speed} onClick={() => { setPlaybackRate(speed); setIsSpeedMenuOpen(false); }} className={`text-center px-[0.5em] py-[0.375em] rounded-lg text-[0.625em] font-bold font-nanum-round transition-colors ${playbackRate === speed ? `bg-${themeColor}-50 text-${themeColor}-600` : 'text-slate-500 hover:bg-gray-50 hover:text-slate-700'}`}>{speed.toFixed(2)}x</button>))}</div></>)}</div>
                            <div className="w-px h-[0.75em] bg-gray-300 shrink-0 hidden sm:block"></div>
                            <button onClick={() => setAutoScroll(!autoScroll)} className={`hidden min-[400px]:flex items-center gap-[0.5em] ${controlPadding} ${controlBtnHeight} rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-all shadow-sm text-slate-600 shrink-0`}><div className={`relative transition-colors duration-200 ease-in-out ${autoScroll ? `bg-${themeColor}-400` : 'bg-gray-300'} w-[1.5em] h-[0.5em] md:w-[1.75em] md:h-[0.75em] lg:w-[2em] lg:h-[1em] rounded-full`}><div className={`absolute top-[0.125em] bg-white rounded-full shadow-sm transition-transform duration-200 left-[0.125em] w-[0.25em] h-[0.25em] md:w-[0.5em] md:h-[0.5em] lg:w-[0.75em] lg:h-[0.75em] ${autoScroll ? 'translate-x-[1em]' : 'translate-x-0'}`}></div></div><span className={`${controlTextSize} font-bold font-nanum-round`}>Auto Scroll</span></button>
                            <div className="w-px h-[0.75em] bg-gray-300 hidden xl:block shrink-0"></div>
                            <button onClick={() => setShowVocab(!showVocab)} className={`hidden xl:flex items-center gap-[0.5em] ${controlPadding} ${controlBtnHeight} rounded-xl border transition-all shadow-sm shrink-0 ${showVocab ? `bg-${themeColor}-50 border-${themeColor}-200 text-${themeColor}-700` : 'bg-white border-gray-200 text-slate-600 hover:bg-gray-50'}`}><OpenBookSolidIcon className="w-[1em] h-[1em]" /><span className={`${controlTextSize} font-bold font-nanum-round hidden sm:inline`}>Vocabulary</span></button>
                        </div>
                    </div>
                );
            };

            const renderHomeHeaderContent = () => {
                return (
                    <div className="flex lg:hidden items-center gap-[0.75em] px-[1em] h-full border-b border-gray-100 bg-white/90 backdrop-blur"><img src="https://raw.githubusercontent.com/openkoreanlearninglab/hub/refs/heads/main/OpenKoreanLearningLab_Logo.jpeg" alt="Logo" className="w-[3em] h-[3em] rounded-2xl shadow-lg object-cover transition-all duration-300"/><div className="flex flex-col justify-center animate-fade-in"><span className="font-cafe24-deco text-[1.25em] text-black leading-tight">Open</span><span className={`font-mustache text-[0.6875em] leading-tight text-${themeColor}-600 font-bold`}>KoreanLearningLab</span></div></div>
                );
            };

            const renderContent = () => {
                switch(activeTab) {
                    case 'home': return <HomeView setActiveTab={setActiveTab} progress={progress} userLevel={userLevel} themeColor={themeColor} />;
                    case 'learn': return <LearnView updateProgress={updateProgress} themeColor={themeColor} autoScroll={autoScroll} showVocab={showVocab} playbackRate={playbackRate} layoutMode={layoutMode} onPlayerReady={handlePlayerReady} onPlayerStateChange={handlePlayerStateChange} onTimeUpdate={handleTimeUpdate} />;
                    case 'vocab': return <VocabView updateProgress={updateProgress} themeColor={themeColor} />;
                    case 'quiz': return <QuizView updateProgress={updateProgress} themeColor={themeColor} />;
                    case 'discuss': return <DiscussView updateProgress={updateProgress} themeColor={themeColor} />;
                    default: return <HomeView setActiveTab={setActiveTab} progress={progress} userLevel={userLevel} themeColor={themeColor} />;
                }
            };

            const sidebarWidth = isSidebarCollapsed ? '5.5rem' : '18.4rem';
            const headerFontSize = activeTab === 'learn' ? '1rem' : '1.3rem';

            return (
                <div className="flex min-h-screen bg-[#f9fafb]">
                    <Sidebar activeTab={activeTab} setActiveTab={setActiveTab} isCollapsed={isSidebarCollapsed} toggleSidebar={toggleSidebar} userLevel={userLevel} themeColor={themeColor} />
                    <div className="flex-1 flex flex-col transition-all duration-300 ease-in-out" style={{ marginLeft: window.innerWidth >= 1024 ? sidebarWidth : 0 }}>
                        <header className={`bg-white transition-all duration-300 z-40 ${activeTab === 'learn' && layoutMode === 'script' ? 'sticky top-0' : 'relative lg:sticky lg:top-0'}`} style={{ height: '4rem', fontSize: headerFontSize }}>
                            {activeTab === 'learn' ? renderLearnHeaderContent() : (activeTab === 'home' ? renderHomeHeaderContent() : null)}
                        </header>
                        <main className={`flex-1 ${mainPaddingClass} flex flex-col ${getScrollClass()}`}>{renderContent()}</main>
                    </div>
                    <nav className="lg:hidden fixed bottom-0 w-full bg-white border-t border-gray-200 flex justify-around p-[0.75rem] z-50">{['home','learn','vocab','quiz','discuss'].map(t=><button key={t} onClick={()=>setActiveTab(t)} className={`p-[0.5rem] rounded-lg ${activeTab===t ? `text-${themeColor}-600 bg-${themeColor}-50` : 'text-slate-400'}`}>{t==='home'?<HomeIcon className="w-[1.5rem] h-[1.5rem]"/>:t==='learn'?<LearnIcon className="w-[1.5rem] h-[1.5rem]"/>:t==='vocab'?<VocabIcon className="w-[1.5rem] h-[1.5rem]"/>:t==='quiz'?<QuizIcon className="w-[1.5rem] h-[1.5rem]"/>:<DiscussIcon className="w-[1.5rem] h-[1.5rem]"/>}</button>)}</nav>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
